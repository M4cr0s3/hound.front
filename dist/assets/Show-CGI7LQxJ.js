import{d as S,a as b,o as u,b as e,p as R,e as n,f as s,w as d,h as p,t as v,s as P,k as _,m as H,B as I,C as z,c as A,l as x,i as M,x as N,q as V,n as L,F,j as O}from"./index-aDw82BAL.js";import{u as W}from"./healthcheck-DK3HWRBB.js";import{I as m}from"./iconify-BqGZZF46.js";import{f as D,a as G}from"./index-BPW3n-1W.js";import{_ as J}from"./IssueItem.vue_vue_type_script_setup_true_lang-B_P4z_Lw.js";import{u as K,i as Q,a as X,b as Y,c as Z,d as ee,e as te,f as se,h as oe,j as ne}from"./install-w9194OeT.js";import{_ as T}from"./EmptyState.vue_vue_type_script_setup_true_lang-CuoVhcgr.js";import{S as C}from"./StatCard-CeepATbu.js";import{_ as re}from"./SelectField.vue_vue_type_script_setup_true_lang-DLPhEYuT.js";import{a as ie,M as U}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-ByYDymtQ.js";import{_ as B}from"./InputField.vue_vue_type_script_setup_true_lang-7Xi4tQX-.js";import{_ as E}from"./Button.vue_vue_type_script_setup_true_lang-CFb8t8J1.js";import"./index-BCqgpTI_.js";import{_ as q}from"./Badge.vue_vue_type_script_setup_true_lang-DvJnhKVF.js";import{u as le}from"./projects-BQEszSKk.js";import"./platforms-D8ztvdxx.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DBtfm7ou.js";const ae={class:"px-5 py-4 hover:bg-gray-50 transition-colors duration-150"},de={class:"flex items-center justify-between"},ce={class:"flex items-center space-x-3 min-w-0"},ue={class:"min-w-0"},pe={class:"mt-1 flex items-center space-x-3"},me={class:"text-xs text-gray-500"},ge={class:"text-xs text-gray-500"},ve={class:"flex items-center space-x-4"},fe=S({__name:"EndpointItem",props:{endpoint:{},slug:{}},setup(w){const i=W();return(o,l)=>{const y=P("RouterLink");return u(),b("div",ae,[e("div",de,[e("div",ce,[e("div",{class:R(["flex-shrink-0",{"text-green-500":o.endpoint.is_active,"text-red-500":!o.endpoint.is_active}])},[n(s(m),{icon:o.endpoint.is_active?"heroicons:check-circle":"heroicons:x-circle",class:"h-5 w-5"},null,8,["icon"])],2),e("div",ue,[n(y,{to:`/healthcheck/${o.endpoint.id}/results`,class:"text-sm font-medium text-gray-900 truncate"},{default:d(()=>[p(v(o.endpoint.url),1)]),_:1},8,["to"]),e("div",pe,[e("span",me," HTTP "+v(o.endpoint.expected_status),1),e("span",ge," Каждые "+v(o.endpoint.interval)+" мин ",1)])])]),e("div",ve,[e("button",{onClick:l[0]||(l[0]=f=>s(i).deleteEndpoint(o.endpoint.id,o.slug)),class:"text-gray-400 hover:text-red-500"},[n(s(m),{icon:"heroicons:trash",class:"h-4 w-4 cursor-pointer"})])])])])}}}),he={class:"px-5 py-4 hover:bg-gray-50 transition-colors duration-150"},xe={class:"flex items-start space-x-3"},ye={class:"min-w-0 flex-1"},_e={class:"text-sm font-medium text-gray-900 truncate"},be={class:"mt-1 flex flex-wrap items-center gap-x-3 gap-y-1"},we={class:"text-xs text-gray-500"},$e=S({__name:"EventItem",props:{event:{},projectSlug:{}},setup(w){return(i,o)=>{const l=P("RouterLink");return u(),b("div",he,[e("div",xe,[e("div",{class:R(["flex-shrink-0 mt-1",{"text-red-500":i.event.level==="error"||i.event.level==="critical","text-amber-500":i.event.level==="warning","text-gray-500":i.event.level==="info"}])},[n(s(m),{icon:{critical:"heroicons:exclamation-triangle",error:"heroicons:exclamation-circle",warning:"heroicons:exclamation-circle",info:"heroicons:information-circle"}[i.event.level],class:"h-5 w-5"},null,8,["icon"])],2),e("div",ye,[e("p",_e,v(i.event.message),1),e("div",be,[e("span",we,v(s(D)(i.event.created_at)),1),e("span",{class:R(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",{"bg-red-100 text-red-800":i.event.level==="error"||i.event.level==="critical","bg-amber-100 text-amber-800":i.event.level==="warning","bg-blue-100 text-blue-800":i.event.level==="info"}])},v(i.event.level),3)])]),n(l,{to:`/events/${i.event.id}`,class:"text-gray-400 hover:text-gray-500"},{default:d(()=>[n(s(m),{icon:"heroicons:chevron-right",class:"h-5 w-5"})]),_:1},8,["to"])])])}}}),ke=S({__name:"LineChart",props:{data:{type:Array,required:!0},title:{type:String,default:""}},setup(w){K([X,Y,Z,ee,te,se,oe,ne]);const i=w,o=_(null);let l=null;const y=()=>{o.value&&(l=Q(o.value),f())},f=()=>{if(!l)return;const c=Math.max(...i.data.map(a=>a.total)),$=Math.ceil(c*1.2),k=i.data.map(a=>a.date),j=i.data.map(a=>a.errors),g=i.data.map(a=>a.warnings),t={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:a=>{const r=a[0].data;return`
          <div class="text-gray-900 font-medium">${a[0].axisValue}</div>
          <div class="mt-2 space-y-1">
            <div class="flex items-center">
              <span class="inline-block w-3 h-3 rounded-full mr-2 bg-[#6366F1]"></span>
              <span>Всего: <strong>${r.total}</strong></span>
            </div>
            <div class="flex items-center">
              <span class="inline-block w-3 h-3 rounded-full mr-2 bg-[#EF4444]"></span>
              <span>Ошибки: <strong>${r.errors}</strong></span>
            </div>
            <div class="flex items-center">
              <span class="inline-block w-3 h-3 rounded-full mr-2 bg-[#F59E0B]"></span>
              <span>Предупреждения: <strong>${r.warnings}</strong></span>
            </div>
          </div>
        `}},legend:{data:["Всего","Ошибки","Предупреждения"],bottom:0},grid:{left:"3%",right:"4%",bottom:"15%",top:i.title?"10%":"5%",containLabel:!0},xAxis:{type:"category",data:k,axisLine:{lineStyle:{color:"#E5E7EB"}},axisLabel:{color:"#6B7280"}},yAxis:{max:$,type:"value",axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"#F3F4F6"}},axisLabel:{color:"#6B7280"}},series:[{name:"Всего",type:"bar",barWidth:"60%",itemStyle:{color:"#6366F1",borderRadius:[12,12,0,0]},data:i.data.map(a=>({value:a.total,total:a.total,errors:a.errors,warnings:a.warnings}))},{name:"Ошибки",type:"line",smooth:!0,symbolSize:8,lineStyle:{width:3,color:"#EF4444"},itemStyle:{color:"#EF4444",borderWidth:2,borderColor:"#fff"},data:j},{name:"Предупреждения",type:"line",smooth:!0,symbolSize:8,lineStyle:{width:3,color:"#F59E0B"},itemStyle:{color:"#F59E0B",borderWidth:2,borderColor:"#fff"},data:g}],...i.title&&{title:{text:i.title,left:"center",textStyle:{color:"#111827",fontWeight:"normal",fontSize:14}}}};l.setOption(t)},h=()=>{l==null||l.resize()};return H(()=>{y(),window.addEventListener("resize",h)}),I(()=>{window.removeEventListener("resize",h),l==null||l.dispose()}),z(()=>i.data,()=>{f()},{deep:!0}),z(()=>i.color,()=>{f()}),(c,$)=>(u(),b("div",{ref_key:"chartRef",ref:o,class:"w-full h-[300px]"},null,512))}}),je={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8"},Ce={class:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4"},Ee={class:"flex items-start space-x-4"},Se={class:"p-3 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-xl shadow-md"},Ve={class:"text-2xl font-bold text-gray-900"},Le={class:"flex flex-wrap items-center gap-2 mt-2"},Fe={class:"flex space-x-3"},Te={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},Be={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Re={class:"lg:col-span-2 space-y-6"},Pe={class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"},ze={class:"p-6"},Me={class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"},Ue={class:"px-6 py-5 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white flex items-center justify-between"},qe={class:"divide-y divide-gray-100"},He={class:"space-y-6"},Ie={class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"},Ae={class:"px-6 py-5 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white flex items-center justify-between"},Ne={class:"divide-y divide-gray-100"},Oe={class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"},We={class:"px-6 py-5 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white flex items-center justify-between"},De={class:"divide-y divide-gray-100"},Ge={class:"text-center"},Je={class:"mt-2 text-sm text-gray-500"},Ke={class:"flex justify-end gap-3"},Qe={class:"flex justify-end gap-3"},vt=S({__name:"Show",setup(w){const i=N(),o=le(),l=_({events_today:0,events_week:0,active_issues:0,uptime_percentage:100}),y=_([]),f=_(!1),h=_(!1),c=_({url:"",expected_status:200,interval:5,method:"GET",is_active:!0}),$=A(()=>o.project.endpoints.length?l.value.uptime_percentage/o.project.endpoints.length:0),k=async()=>{try{const g=await M.get(`/projects/${i.params.slug}`);o.project=g.project,l.value=g.stats,y.value=g.daily_stats}catch(g){console.error("Error fetching project:",g)}},j=async()=>{try{await M.post(`/healthcheck/${o.project.slug}`,c.value),await k(),h.value=!1,c.value={url:"",expected_status:200,interval:5,method:"GET",is_active:!0}}catch(g){console.error("Error adding endpoint:",g)}};return H(()=>{k()}),(g,t)=>{const a=P("RouterLink");return u(),x(ie,null,{default:d(()=>[e("div",je,[e("div",Ce,[e("div",Ee,[e("div",Se,[n(s(m),{icon:s(G)(s(o).project.platform),class:"h-8 w-8 text-white"},null,8,["icon"])]),e("div",null,[e("h1",Ve,v(s(o).project.name),1),e("div",Le,[n(s(q),{variant:"primary",class:"flex items-center"},{default:d(()=>{var r;return[n(s(m),{icon:"heroicons:user-group",class:"mr-1 h-4 w-4"}),p(" "+v((r=s(o).project.team)==null?void 0:r.name),1)]}),_:1}),n(s(q),{variant:"secondary",class:"flex items-center"},{default:d(()=>[n(s(m),{icon:"heroicons:computer-desktop",class:"mr-1 h-4 w-4"}),p(" "+v(s(o).project.platform),1)]),_:1})])])]),e("div",Fe,[n(a,{to:`/projects/${s(o).project.slug}/settings/general`,class:"inline-flex items-center px-4 py-2 bg-white border border-gray-200 text-gray-700 text-sm font-medium rounded-lg shadow-sm hover:bg-gray-50 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"},{default:d(()=>[n(s(m),{icon:"heroicons:cog-6-tooth",class:"mr-2 h-4 w-4"}),t[11]||(t[11]=p(" Настройки "))]),_:1},8,["to"]),e("button",{onClick:t[0]||(t[0]=r=>f.value=!0),class:"inline-flex items-center px-4 py-2 cursor-pointer bg-white border border-gray-200 text-red-600 text-sm font-medium rounded-lg shadow-sm hover:bg-red-50 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2"},[n(s(m),{icon:"heroicons:trash",class:"mr-2 h-4 w-4"}),t[12]||(t[12]=p(" Удалить "))])])]),e("div",Te,[n(C,{title:"Событий сегодня",value:l.value.events_today,icon:"heroicons:bell-alert"},null,8,["value"]),n(C,{title:"Событий за неделю",value:l.value.events_week,icon:"heroicons:calendar-days"},null,8,["value"]),n(C,{title:"Активных задач",value:l.value.active_issues,icon:"heroicons:exclamation-triangle",variant:"warning"},null,8,["value"]),n(C,{title:"Uptime",value:`${$.value}%`,icon:"heroicons:shield-check",variant:"success"},null,8,["value"])]),e("div",Be,[e("div",Re,[e("div",Pe,[t[13]||(t[13]=e("div",{class:"px-6 py-5 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white"},[e("h2",{class:"text-lg font-semibold text-gray-900"},"Активность (7 дней)")],-1)),e("div",ze,[n(ke,{data:y.value,title:"Активность событий",color:"#8B5CF6","show-mark-line":!0},null,8,["data"])])]),e("div",Me,[e("div",Ue,[t[15]||(t[15]=e("h2",{class:"text-lg font-semibold text-gray-900"},"Последние события",-1)),n(a,{to:`/projects/${s(o).project.slug}/events`,class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"},{default:d(()=>t[14]||(t[14]=[p(" Показать все ")])),_:1},8,["to"])]),e("div",qe,[(u(!0),b(F,null,L(s(o).project.events,r=>(u(),x($e,{key:r.id,event:r,class:"hover:bg-gray-50 transition-colors duration-150","project-slug":s(o).project.slug},null,8,["event","project-slug"]))),128)),s(o).project.events.length?V("",!0):(u(),x(s(T),{key:0,title:"Событий не найдено",icon:"heroicons:bell",description:"Здесь будут отображаться последние события вашего проекта.",class:"p-6",small:""}))])])]),e("div",He,[e("div",Ie,[e("div",Ae,[t[16]||(t[16]=e("h2",{class:"text-lg font-semibold text-gray-900"},"Health Check Endpoints",-1)),e("button",{onClick:t[1]||(t[1]=r=>h.value=!0),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium cursor-pointer"},[n(s(m),{icon:"heroicons:plus",class:"h-4 w-4"})])]),e("div",Ne,[(u(!0),b(F,null,L(s(o).project.endpoints,r=>(u(),x(fe,{slug:s(o).project.slug,key:r.id,endpoint:r,class:"hover:bg-gray-50 transition-colors duration-150"},null,8,["slug","endpoint"]))),128)),s(o).project.endpoints.length?V("",!0):(u(),x(s(T),{key:0,title:"Нет endpoints",icon:"heroicons:link",description:"Добавьте health check endpoints для мониторинга.",class:"p-6",small:""}))])]),e("div",Oe,[e("div",We,[t[18]||(t[18]=e("h2",{class:"text-lg font-semibold text-gray-900"},"Последние проблемы",-1)),n(a,{to:`/projects/${s(o).project.slug}/issues`,class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"},{default:d(()=>t[17]||(t[17]=[p(" Показать все ")])),_:1},8,["to"])]),e("div",De,[(u(!0),b(F,null,L(s(o).project.issues,r=>(u(),x(J,{key:r.id,issue:r,class:"hover:bg-gray-50 transition-colors duration-150","project-slug":s(o).project.slug},null,8,["issue","project-slug"]))),128)),s(o).project.issues.length?V("",!0):(u(),x(s(T),{key:0,title:"Проблем не найдено",icon:"heroicons:check-badge",description:"Отличная работа! Активных проблем нет.",class:"p-6",small:""}))])])])])]),n(s(U),{"is-open":f.value,onClose:t[4]||(t[4]=r=>f.value=!1),title:"Подтверждение удаления"},{content:d(()=>[e("div",Ge,[n(s(m),{icon:"heroicons:exclamation-triangle",class:"mx-auto h-12 w-12 text-red-500"}),t[20]||(t[20]=e("h3",{class:"mt-2 text-lg font-medium text-gray-900"},"Удалить проект?",-1)),e("div",Je,[e("p",null,'Вы уверены, что хотите удалить проект "'+v(s(o).project.name)+'"?',1),t[19]||(t[19]=e("p",{class:"mt-1"},"Это действие нельзя отменить.",-1))])])]),footer:d(()=>[e("div",Ke,[n(s(E),{variant:"secondary",onClick:t[2]||(t[2]=r=>f.value=!1)},{default:d(()=>t[21]||(t[21]=[p(" Отмена ")])),_:1}),n(s(E),{variant:"danger",onClick:t[3]||(t[3]=r=>s(o).destroy(s(o).project.slug))},{default:d(()=>t[22]||(t[22]=[p(" Удалить ")])),_:1})])]),_:1},8,["is-open"]),n(s(U),{"is-open":h.value,onClose:t[10]||(t[10]=r=>h.value=!1),title:"Добавить Health Check Endpoint"},{content:d(()=>[e("form",{onSubmit:O(j,["prevent"]),class:"space-y-4"},[n(s(B),{id:"endpoint-url",modelValue:c.value.url,"onUpdate:modelValue":t[5]||(t[5]=r=>c.value.url=r),label:"URL Endpoint",placeholder:"https://example.com/health",required:"",icon:"heroicons:link"},null,8,["modelValue"]),n(s(B),{id:"exp-status",modelValue:c.value.expected_status,"onUpdate:modelValue":t[6]||(t[6]=r=>c.value.expected_status=r),label:"Ожидаемый HTTP статус",type:"number",placeholder:"200",required:"",icon:"heroicons:hashtag",minValue:1,maxValue:550},null,8,["modelValue"]),n(s(B),{modelValue:c.value.interval,"onUpdate:modelValue":t[7]||(t[7]=r=>c.value.interval=r),label:"Интервал проверки (минуты)",type:"number",placeholder:"5",required:"",icon:"heroicons:clock",id:"check-interval",minValue:1,maxValue:60},null,8,["modelValue"]),n(s(re),{options:["GET","POST","PUT","PATCH","OPTIONS"],modelValue:c.value.method,"onUpdate:modelValue":t[8]||(t[8]=r=>c.value.method=r),label:"Метод",required:""},null,8,["modelValue"])],32)]),footer:d(()=>[e("div",Qe,[n(s(E),{variant:"secondary",onClick:t[9]||(t[9]=r=>h.value=!1)},{default:d(()=>t[23]||(t[23]=[p(" Отмена ")])),_:1}),n(s(E),{onClick:j},{default:d(()=>t[24]||(t[24]=[p(" Добавить ")])),_:1})])]),_:1},8,["is-open"])]),_:1})}}});export{vt as default};
