import{c as k,a as C}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-B9luPsYv.js";import{_ as L}from"./EmptyState.vue_vue_type_script_setup_true_lang-Cmime_Ld.js";import{d as y,u as b,k as U,K as $,l as d,o as l,f as t,ac as R,w as u,b as n,e as w,p as S,t as B,m as M,q as N,s as P,h as I,a as _,F as T,n as V}from"./index-BzaUVgPz.js";import{R as g}from"./types-Cl0W0wgk.js";import{I as D}from"./iconify-C9_GRU0G.js";import{_ as F}from"./DataTable.vue_vue_type_script_setup_true_lang-Ws8kjy26.js";import"./index-BCqgpTI_.js";import"./index-C5R5Ulkp.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./projects-CPmE4kLQ.js";const K={class:"text-center"},j=y({__name:"UsersTable",props:{users:{},pagination:{},isLoading:{type:Boolean}},emits:["select","page-change"],setup(v,{emit:s}){var x;const m=s,r=b(),o=[{key:"name",title:"Имя"},{key:"email",title:"Почта"},{key:"role",title:"Роль"},{key:"actions",title:"Действия",visible:((x=r.currentUser)==null?void 0:x.role.title)===g.Maintainer}],f=U([{icon:"heroicons:clipboard",label:"Скопировать инвайт-ссылку",handler:e=>p(e),visible:e=>{var i;return(i=e.invitations)==null?void 0:i.length}},{icon:"heroicons:trash",label:"Удалить",iconClass:"text-red-500",handler:e=>r.destroy(e.id),visible:e=>r.currentUser.id!==e.id}]),p=async e=>{var a;const i=new URL(window.location.origin),c=(a=e.invitations)==null?void 0:a.length;c&&(i.pathname=`/invite/${e.invitations[c-1].token}`,await navigator.clipboard.writeText(i.toString()),$.success("Ссылка скопирована в буфер обмена"))},h=e=>{if(e){const i=new URL(e).searchParams.get("page");i&&m("page-change",i)}};return(e,i)=>{var c;return l(),d(t(F),{columns:o,data:e.users,pagination:e.pagination,"is-loading":e.isLoading,"row-clickable":"",onRowClick:i[0]||(i[0]=a=>m("select",a)),onPageChange:h,"row-class":"text-sm text-gray-700","pagination-text":"пользователей"},R({"cell-role":u(({value:a})=>[n("span",{class:S([{"bg-green-100 text-green-800":a.title===t(g).Maintainer,"bg-blue-100 text-blue-800":a.title===t(g).Developer},"px-2 inline-flex text-xs leading-5 font-semibold rounded-full"])},B(a.title),3)]),_:2},[((c=t(r).currentUser)==null?void 0:c.role.title)===t(g).Maintainer?{name:"cell-actions",fn:u(({row:a})=>[n("td",K,[w(t(k),{row:a,actions:f.value},null,8,["row","actions"])])]),key:"0"}:void 0]),1032,["data","pagination","is-loading"])}}}),q={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},z={class:"flex justify-between items-center mb-6"},E={class:"bg-white shadow rounded-lg overflow-hidden"},A={key:0,class:"divide-y divide-gray-200"},te=y({__name:"Index",setup(v){const s=b(),m=r=>{s.filters.page=Number(r),s.fetchUsers()};return M(async()=>{await s.fetchUsers()}),(r,o)=>{const f=P("RouterLink");return l(),d(C,null,{default:u(()=>{var p;return[n("div",q,[n("div",z,[o[1]||(o[1]=n("h1",{class:"text-2xl font-bold text-gray-900"},"Пользователи",-1)),((p=t(s).currentUser.role)==null?void 0:p.title)===t(g).Maintainer?(l(),d(f,{key:0,to:"/users/create",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},{default:u(()=>[w(t(D),{icon:"heroicons:plus",class:"-ml-1 mr-2 h-5 w-5"}),o[0]||(o[0]=I(" Добавить пользователя "))]),_:1})):N("",!0)]),n("div",E,[t(s).isLoading?(l(),_("ul",A,[(l(),_(T,null,V(5,h=>n("li",{key:`skeleton-${h}`,class:"px-4 py-4 sm:px-6"},o[2]||(o[2]=[n("div",{class:"flex items-center space-x-4 animate-pulse"},[n("div",{class:"flex-shrink-0 h-10 w-10 rounded-md bg-gray-200"}),n("div",{class:"flex-1 min-w-0 space-y-2"},[n("div",{class:"h-4 bg-gray-200 rounded w-3/4"}),n("div",{class:"h-3 bg-gray-100 rounded w-1/2"})])],-1)]))),64))])):!t(s).users.length&&!t(s).isLoading?(l(),d(t(L),{key:1,title:"Пользователи не найдены",icon:"heroicons:users",description:"Добавьте пользователей, чтобы увидеть их здесь."})):(l(),d(t(j),{key:2,users:t(s).users,pagination:t(s).pagination,"is-loading":t(s).isLoading,onPageChange:m},null,8,["users","pagination","is-loading"]))])])]}),_:1})}}});export{te as default};
