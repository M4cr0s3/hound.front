import{ac as q,k as _,i as z,d as K,c as B,m as G,l as D,w as p,o,a as i,q as d,f as e,b as t,a6 as k,e as l,p as N,t as r,F as R,n as T,h as f,a7 as w,s as H}from"./index-B605mWSS.js";import{_ as J}from"./EmptyState.vue_vue_type_script_setup_true_lang-6tWArOav.js";import{I as m}from"./iconify-e9sR0ZFq.js";import{_ as C}from"./Badge.vue_vue_type_script_setup_true_lang-BJ0lmBAF.js";import"./StacktraceViewer.vue_vue_type_style_index_0_scoped_8568d111_lang-OogGfIpQ.js";import{d as Q,a as U}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-BKjXbmz5.js";import{_ as W,S as X}from"./StacktraceViewer-De--8S04.js";import{P as Y}from"./platforms-D8ztvdxx.js";import{b as F,c as Z,d as ee,f as M,g as te,e as se}from"./index-BPW3n-1W.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-p83CCQy-.js";import"./projects-DhOs14FM.js";const ne=q("events",()=>{const g=_([]),x=_({id:0,name:"",description:"",type:"",level:"info",metadata:{},event_id:"",count:0,message:"",release:"",project_id:0,environment:"",project:{},issues:[]}),s=_(!1);return{events:g,event:x,fetchEvent:async h=>{s.value=!0;try{x.value=await z.get(`/events/${h}`)}finally{s.value=!1}}}}),oe={key:0,class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},ie={class:"flex items-center mb-6"},le={class:"inline-flex items-center space-x-1 md:space-x-2"},re={class:"flex items-center"},de={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6"},ce={class:"flex items-center gap-3"},me={class:"text-xl font-semibold text-gray-900 line-clamp-2"},ve={class:"flex items-center gap-2 mt-1"},xe={class:"text-xs text-gray-500"},ue={key:0,class:"text-xs px-2 py-0.5 bg-gray-100 text-gray-600 rounded-full"},pe={class:"mb-6"},fe={class:"flex space-x-4 border-b border-gray-200"},_e=["onClick"],ge={key:0,class:"absolute inset-x-0 bottom-0 h-0.5 bg-indigo-600"},he={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},ye={class:"bg-white rounded-lg shadow overflow-hidden"},be={class:"px-6 py-4 space-y-4"},ke={key:0,class:"flex items-start"},we={class:"text-sm text-gray-900 font-mono break-all"},Ce={key:1,class:"flex items-start"},Se={key:2,class:"flex items-start"},je={class:"text-sm text-gray-900"},$e={key:3,class:"flex items-start"},Le={class:"text-sm text-gray-900"},Ie={class:"bg-white rounded-lg shadow overflow-hidden"},Ve={class:"px-6 py-4"},Ee={class:"flex items-center"},Be={class:"flex-shrink-0 h-10 w-10 flex items-center justify-center p-3 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-xl shadow-md"},De={class:"ml-4"},Ne={class:"text-sm font-medium text-gray-900"},Re={class:"text-sm text-gray-500"},Te={key:0,class:"bg-white rounded-lg shadow overflow-hidden mb-6"},Fe={class:"px-6 py-4"},Me={key:0},Ae={key:0,class:"bg-white rounded-lg shadow overflow-hidden mb-6"},Oe={class:"divide-y divide-gray-200"},Pe={class:"flex items-center justify-between"},qe={class:"flex items-center gap-2"},ze={class:"text-sm font-medium text-gray-900"},Ke={class:"text-sm text-gray-500 mt-1"},Ge=K({__name:"Show",props:{id:{}},setup(g){const x=g,s=ne(),c=_("details");Q();const h=[{id:"details",name:"Детали"},{id:"stacktrace",name:"Stacktrace"},{id:"issues",name:"Проблемы"}],A=B(()=>{const y=s.event.metadata||{},a=["file","line","stacktrace"];return Object.keys(y).some(v=>!a.includes(v))}),O=B(()=>{const{file:y,line:a,stacktrace:v,...u}=s.event.metadata||{};return u});function P(){console.log("Create issue from event",s.event)}return G(async()=>{await s.fetchEvent(+x.id)}),(y,a)=>{const v=H("RouterLink");return o(),D(U,null,{default:p(()=>{var u,S,j,$,L,I,V;return[(u=e(s))!=null&&u.event?(o(),i("div",oe,[t("nav",ie,[t("ol",le,[t("li",null,[t("div",re,[l(e(m),{icon:"mdi:chevron-right",class:"h-4 w-4 text-gray-400"}),a[0]||(a[0]=t("span",{class:"ml-1 text-sm font-medium text-gray-500 md:ml-2"},"Детали события",-1))])])])]),t("div",de,[t("div",ce,[t("div",{class:N(["p-2 rounded-lg",`bg-${e(F)(e(s).event.level)}-100 text-${e(F)(e(s).event.level)}-600`])},[l(e(m),{icon:e(Z)(e(s).event.level),class:"h-5 w-5"},null,8,["icon"])],2),t("div",null,[t("h1",me,r(e(s).event.message),1),t("div",ve,[l(e(C),{variant:e(ee)(e(s).event.level),text:e(s).event.level,class:"text-xs"},null,8,["variant","text"]),t("span",xe,r(e(M)(e(s).event.created_at)),1),e(s).event.count>1?(o(),i("span",ue," Повторений: "+r(e(s).event.count),1)):d("",!0)])])])]),t("div",pe,[t("nav",fe,[(o(),i(R,null,T(h,n=>t("button",{key:n.id,onClick:b=>c.value=n.id,class:N(["px-4 py-2 text-sm font-medium relative cursor-pointer",{"text-indigo-600":c.value===n.id,"text-gray-500 hover:text-gray-700":c.value!==n.id}])},[f(r(n.name)+" ",1),c.value===n.id?(o(),i("span",ge)):d("",!0)],10,_e)),64))])]),k(t("div",null,[t("div",he,[t("div",ye,[a[5]||(a[5]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-sm font-medium text-gray-900"},"Основная информация")],-1)),t("div",be,[(S=e(s).event.metadata)!=null&&S.file?(o(),i("div",ke,[a[1]||(a[1]=t("span",{class:"text-sm text-gray-500 w-32 flex-shrink-0"},"Файл:",-1)),t("span",we,r(e(s).event.metadata.file)+":"+r(e(s).event.metadata.line||"?"),1)])):d("",!0),e(s).event.type?(o(),i("div",Ce,[a[2]||(a[2]=t("span",{class:"text-sm text-gray-500 w-32 flex-shrink-0"},"Тип:",-1)),l(e(C),{text:e(s).event.type,class:"text-xs",variant:"default"},null,8,["text"])])):d("",!0),e(s).event.environment?(o(),i("div",Se,[a[3]||(a[3]=t("span",{class:"text-sm text-gray-500 w-32 flex-shrink-0"},"Окружение:",-1)),t("span",je,r(e(s).event.environment),1)])):d("",!0),e(s).event.release?(o(),i("div",$e,[a[4]||(a[4]=t("span",{class:"text-sm text-gray-500 w-32 flex-shrink-0"},"Релиз:",-1)),t("span",Le,r(e(s).event.release),1)])):d("",!0)])]),t("div",Ie,[a[7]||(a[7]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-sm font-medium text-gray-900"},"Проект")],-1)),t("div",Ve,[t("div",Ee,[t("div",Be,[l(e(m),{icon:((j=e(Y).find(n=>{var b,E;return n.name===((E=(b=e(s))==null?void 0:b.event.project)==null?void 0:E.platform)}))==null?void 0:j.icon)||" ",class:"h-5 w-5"},null,8,["icon"])]),t("div",De,[t("h4",Ne,r(($=e(s).event.project)==null?void 0:$.name),1),t("p",Re,r((L=e(s).event.project)==null?void 0:L.slug),1),l(v,{to:`/projects/${(I=e(s).event.project)==null?void 0:I.slug}`,class:"mt-1 inline-flex items-center text-xs text-indigo-600 hover:text-indigo-800"},{default:p(()=>[a[6]||(a[6]=f(" Перейти в проект ")),l(e(m),{icon:"mdi:chevron-right",class:"h-4 w-4"})]),_:1},8,["to"])])])])])]),A.value?(o(),i("div",Te,[a[8]||(a[8]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-sm font-medium text-gray-900"},"Контекст события")],-1)),t("div",Fe,[l(e(W),{class:"text-sm",data:O.value},null,8,["data"])])])):d("",!0)],512),[[w,c.value==="details"]]),e(s).event.metadata.stacktrace?k((o(),i("div",Me,[l(e(X),{stacktrace:e(s).event.metadata.stacktrace,class:"mb-6"},null,8,["stacktrace"])],512)),[[w,c.value==="stacktrace"&&((V=e(s).event)==null?void 0:V.metadata.stacktrace)]]):d("",!0),k(t("div",null,[e(s).event.issues&&e(s).event.issues.length>0?(o(),i("div",Ae,[a[10]||(a[10]=t("div",{class:"px-6 py-4 border-b border-gray-200 flex justify-between items-center"},[t("h3",{class:"text-sm font-medium text-gray-900"},"Связанные проблемы")],-1)),t("div",Oe,[(o(!0),i(R,null,T(e(s).event.issues,n=>(o(),i("div",{key:n.id,class:"px-6 py-4 hover:bg-gray-50"},[t("div",Pe,[t("div",null,[t("div",qe,[t("h4",ze,r(n.title),1),l(e(C),{variant:e(se)(n.status),text:e(te)(n.status),class:"text-xs"},null,8,["variant","text"])]),t("p",Ke," Создана "+r(e(M)(n.created_at)),1)]),l(v,{to:`/issues/${n.id}`,class:"inline-flex items-center text-sm text-indigo-600 hover:text-indigo-800"},{default:p(()=>[a[9]||(a[9]=f(" Подробнее ")),l(e(m),{icon:"mdi:chevron-right",class:"h-4 w-4"})]),_:2},1032,["to"])])]))),128))])])):(o(),D(e(J),{key:1,title:"Нет связанных задач",description:"Это событие еще не связано ни с одной задачей.",icon:"mdi:alert-circle-outline"},{default:p(()=>[t("button",{onClick:P,class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none"},[l(e(m),{icon:"mdi:plus",class:"h-5 w-5 mr-2"}),a[11]||(a[11]=f(" Создать проблему "))])]),_:1}))],512),[[w,c.value==="issues"]])])):d("",!0)]}),_:1})}}}),nt=ae(Ge,[["__scopeId","data-v-eacc59f2"]]);export{nt as default};
