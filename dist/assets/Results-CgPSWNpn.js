import{d as I,k as N,m as B,C as j,a as u,o as l,x as A,c as d,l as S,w as F,b as e,e as i,q as w,f as n,t as h,h as E,n as V,F as z,p as q}from"./index-yA2_g0IP.js";import{I as x}from"./iconify-jQ1gWvGX.js";import{a as P}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-BAH6DOjV.js";import{u as G}from"./healthcheck-D2yVlnJM.js";import{f as M}from"./index-FUb4nFco.js";import{_ as J}from"./Button.vue_vue_type_script_setup_true_lang-C-UAtDVx.js";import"./index-BCqgpTI_.js";import{_ as K}from"./Badge.vue_vue_type_script_setup_true_lang-Cq2QGjl2.js";import{_ as Q}from"./EmptyState.vue_vue_type_script_setup_true_lang-CdKZCj2n.js";import"./index-Cx72w7ih.js";import{i as U,L as W}from"./install-w9194OeT.js";import{S as _}from"./StatCard-Bhr6fG_X.js";import{_ as X}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DWr4-LFR.js";import"./projects-CMXkZdk3.js";const Y=I({__name:"ResponseTimeChart",props:{data:{type:Array,required:!0}},setup(k){const v=k,m=N(null);B(()=>{r()}),j(()=>v.data,()=>{r()});function r(){if(!m.value)return;const f=U(m.value),p={tooltip:{trigger:"axis",formatter:c=>{const o=c[0];return`${o.axisValue}: ${o.value}ms`}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:v.data.map(c=>c.hour),axisLabel:{rotate:45}},yAxis:{type:"value",name:"Время ответа (ms)",axisLine:{show:!0}},series:[{name:"Время ответа",type:"line",smooth:!0,data:v.data.map(c=>c.avg_time),itemStyle:{color:"#4f46e5"},areaStyle:{color:new W(0,0,0,1,[{offset:0,color:"rgba(79, 70, 229, 0.3)"},{offset:1,color:"rgba(79, 70, 229, 0.1)"}])}}]};f.setOption(p),new ResizeObserver(()=>{f.resize()}).observe(m.value)}return(f,p)=>(l(),u("div",{ref_key:"chartRef",ref:m,class:"w-full h-full"},null,512))}}),Z={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},ee={class:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4 mb-8"},te={class:"flex items-center space-x-3"},se={class:"p-2 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-lg"},oe={key:0,class:"mt-2 flex items-center space-x-2"},ae={class:"px-2 py-1 text-xs font-medium rounded bg-indigo-100 text-indigo-800"},re={class:"text-sm text-gray-600 truncate max-w-md"},ie={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},ne={class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden mb-8"},le={class:"p-6 h-80"},ce={class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"},de={class:"divide-y divide-gray-100"},ue={class:"flex items-center justify-between"},me={class:"flex items-center space-x-4"},pe={class:"flex-shrink-0"},ve={class:"text-sm font-medium text-gray-900"},fe={class:"text-sm text-gray-500"},he={class:"flex items-center space-x-4"},ge=["onClick"],xe={key:0,class:"mt-3 p-3 bg-red-50 text-red-800 text-sm rounded-lg border border-red-100"},_e={class:"mt-1 break-words"},be=I({__name:"Results",setup(k){const v=A(),m=Number(v.params.endpointId),r=G(),{fetchEndpointResults:f}=r,p=d(()=>r.results),g=d(()=>r.stats),c=d(()=>r.isLoading),o=d(()=>r.chartData),C=d(()=>p.value[0]),b=N(null),D=d(()=>{if(!o.value||o.value.length<2)return null;const a=o.value[0].response_time,t=o.value[o.value.length-1].response_time;return t>a?"up":t<a?"down":null}),H=d(()=>{if(!o.value||o.value.length<2)return null;const a=o.value[0].response_time;return`${((o.value[o.value.length-1].response_time-a)/a*100).toFixed(2)}%`}),O=a=>{if(!a.success){const t=a.error_message||`HTTP ${a.status_code}`;navigator.clipboard.writeText(t),b.value=a.id,setTimeout(()=>b.value=null,2e3)}};return B(async()=>{await f(m)}),(a,t)=>(l(),S(P,null,{default:F(()=>{var y,T,$,R,L;return[e("div",Z,[e("div",ee,[e("div",null,[e("div",te,[e("div",se,[i(n(x),{icon:"heroicons:heart",class:"h-6 w-6 text-white"})]),t[1]||(t[1]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Health Check Мониторинг",-1))]),n(r).endpoint?(l(),u("div",oe,[e("span",ae,h(n(r).endpoint.method),1),e("p",re,h(n(r).endpoint.url),1)])):w("",!0)]),i(n(J),{onClick:t[0]||(t[0]=s=>a.$router.back()),variant:"outline",class:"self-start sm:self-center"},{default:F(()=>[i(n(x),{icon:"heroicons:arrow-left",class:"mr-2 h-4 w-4"}),t[2]||(t[2]=E(" Назад "))]),_:1})]),e("div",ie,[i(_,{title:"Ср. время ответа",value:`${((y=g.value)==null?void 0:y.avg_response_time.toFixed(2))??0}ms`,icon:"heroicons:clock",trend:D.value,"trend-value":H.value},null,8,["value","trend","trend-value"]),i(_,{title:"Аптайм",value:`${((T=g.value)==null?void 0:T.uptime_percentage.toFixed(2))??100}%`,icon:"heroicons:shield-check",variant:"success"},null,8,["value"]),i(_,{title:"Всего проверок",value:(($=g.value)==null?void 0:$.total_checks)??0,icon:"heroicons:check-badge",variant:"primary"},null,8,["value"]),i(_,{title:"Последний статус",value:((R=C.value)==null?void 0:R.status_code)??"-",variant:(L=C.value)!=null&&L.success?"success":"danger",icon:"heroicons:exclamation-circle"},null,8,["value","variant"])]),e("div",ne,[t[3]||(t[3]=e("div",{class:"px-6 py-5 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white"},[e("h2",{class:"text-lg font-semibold text-gray-900"},"Время ответа (последние 24 часа)")],-1)),e("div",le,[i(Y,{data:o.value},null,8,["data"])])]),e("div",ce,[t[6]||(t[6]=e("div",{class:"px-6 py-5 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white"},[e("h2",{class:"text-lg font-semibold text-gray-900"},"История проверок")],-1)),e("div",de,[c.value?(l(),u(z,{key:0},V(5,s=>e("div",{key:s,class:"p-6"},t[4]||(t[4]=[e("div",{class:"animate-pulse flex space-x-4"},[e("div",{class:"flex-1 space-y-4 py-1"},[e("div",{class:"h-4 bg-gray-100 rounded w-3/4"}),e("div",{class:"space-y-2"},[e("div",{class:"h-4 bg-gray-100 rounded"})])])],-1)]))),64)):p.value.length===0?(l(),S(n(Q),{key:1,title:"Нет данных",icon:"heroicons:inbox",description:"Здесь будут отображаться результаты проверок",class:"p-8"})):(l(!0),u(z,{key:2},V(p.value,s=>(l(),u("div",{key:s.id,class:"p-5 hover:bg-gray-50 transition-colors duration-150"},[e("div",ue,[e("div",me,[e("div",pe,[e("div",{class:q(["h-10 w-10 rounded-full flex items-center justify-center",s.success?"bg-green-100 text-green-600":"bg-red-100 text-red-600"])},[i(n(x),{icon:s.success?"heroicons:check":"heroicons:x-mark",class:"h-5 w-5"},null,8,["icon"])],2)]),e("div",null,[e("p",ve,h(n(M)(s.created_at)),1),e("p",fe,h(s.response_time.toFixed(2))+" ms ",1)])]),e("div",he,[i(n(K),{variant:s.success?"success":"danger",text:`HTTP ${s.status_code}`},null,8,["variant","text"]),s.success?w("",!0):(l(),u("button",{key:0,onClick:ye=>O(s),class:"text-gray-400 hover:text-gray-600",title:"Копировать ошибку"},[i(n(x),{icon:"heroicons:clipboard",class:"h-5 w-5"})],8,ge))])]),!s.success&&b.value===s.id?(l(),u("div",xe,[t[5]||(t[5]=e("p",{class:"font-medium"},"Ошибка:",-1)),e("p",_e,h(s.error_message||"Нет описания ошибки"),1)])):w("",!0)]))),128))])])])]}),_:1}))}}),He=X(be,[["__scopeId","data-v-32ad2bc2"]]);export{He as default};
