import{c as L,a as U}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-BKjXbmz5.js";import{_ as $}from"./EmptyState.vue_vue_type_script_setup_true_lang-6tWArOav.js";import{d as v,u as w,k as R,K as S,l as g,o as l,f as t,D as B,w as f,b as n,e as k,p as M,t as N,m as P,q as I,s as T,h as V,a as b,F as D,n as F}from"./index-B605mWSS.js";import{R as m}from"./types-CpYKjTMI.js";import{I as K}from"./iconify-e9sR0ZFq.js";import"./StacktraceViewer.vue_vue_type_style_index_0_scoped_8568d111_lang-OogGfIpQ.js";import{_ as j}from"./Pagination.vue_vue_type_script_setup_true_lang-DG5CJXSe.js";import"./index-p83CCQy-.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./projects-DhOs14FM.js";const q={class:"text-center"},z=v({__name:"UsersTable",props:{users:{},pagination:{},isLoading:{type:Boolean}},emits:["select","page-change"],setup(C,{emit:s}){var y,_;const p=s,o=w(),a=[{key:"name",title:"Имя"},{key:"email",title:"Почта"},{key:"role",title:"Роль"},{key:"actions",title:"Действия",visible:((_=(y=o.currentUser)==null?void 0:y.role)==null?void 0:_.title)===m.Maintainer}],h=R([{icon:"heroicons:clipboard",label:"Скопировать инвайт-ссылку",handler:e=>u(e),visible:e=>{var i;return(i=e.invitations)==null?void 0:i.length},key:""},{icon:"heroicons:trash",label:"Удалить",iconClass:"text-red-500",handler:e=>o.destroy(e.id),visible:e=>o.currentUser.id!==e.id,key:""}]),u=async e=>{var d;const i=new URL(window.location.origin),c=(d=e.invitations)==null?void 0:d.length;!e.invitations||!c||(i.pathname=`/invite/${e.invitations[c-1].token}`,await navigator.clipboard.writeText(i.toString()),S.success("Ссылка скопирована в буфер обмена"))},x=e=>{if(e){const i=new URL(e).searchParams.get("page");i&&p("page-change",i)}};return(e,i)=>{var c,d;return l(),g(t(j),{columns:a,data:e.users,pagination:e.pagination,"is-loading":e.isLoading,"row-clickable":"",onRowClick:i[0]||(i[0]=r=>p("select",r)),onPageChange:x,"row-class":"text-sm text-gray-700","pagination-text":"пользователей"},B({"cell-role":f(({value:r})=>[n("span",{class:M([{"bg-green-100 text-green-800":r.title===t(m).Maintainer,"bg-blue-100 text-blue-800":r.title===t(m).Developer},"px-2 inline-flex text-xs leading-5 font-semibold rounded-full"])},N(r.title),3)]),_:2},[((d=(c=t(o).currentUser)==null?void 0:c.role)==null?void 0:d.title)===t(m).Maintainer?{name:"cell-actions",fn:f(({row:r})=>[n("td",q,[k(t(L),{row:r,actions:h.value},null,8,["row","actions"])])]),key:"0"}:void 0]),1032,["data","pagination","is-loading"])}}}),E={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},A={class:"flex justify-between items-center mb-6"},G={class:"bg-white shadow rounded-lg overflow-hidden"},H={key:0,class:"divide-y divide-gray-200"},ne=v({__name:"Index",setup(C){const s=w(),p=o=>{s.filters.page=Number(o),s.fetchUsers()};return P(async()=>{await s.fetchUsers()}),(o,a)=>{const h=T("RouterLink");return l(),g(U,null,{default:f(()=>{var u;return[n("div",E,[n("div",A,[a[1]||(a[1]=n("h1",{class:"text-2xl font-bold text-gray-900"},"Пользователи",-1)),((u=t(s).currentUser.role)==null?void 0:u.title)===t(m).Maintainer?(l(),g(h,{key:0,to:"/users/create",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},{default:f(()=>[k(t(K),{icon:"heroicons:plus",class:"-ml-1 mr-2 h-5 w-5"}),a[0]||(a[0]=V(" Добавить пользователя "))]),_:1})):I("",!0)]),n("div",G,[t(s).isLoading?(l(),b("ul",H,[(l(),b(D,null,F(5,x=>n("li",{key:`skeleton-${x}`,class:"px-4 py-4 sm:px-6"},a[2]||(a[2]=[n("div",{class:"flex items-center space-x-4 animate-pulse"},[n("div",{class:"flex-shrink-0 h-10 w-10 rounded-md bg-gray-200"}),n("div",{class:"flex-1 min-w-0 space-y-2"},[n("div",{class:"h-4 bg-gray-200 rounded w-3/4"}),n("div",{class:"h-3 bg-gray-100 rounded w-1/2"})])],-1)]))),64))])):!t(s).users.length&&!t(s).isLoading?(l(),g(t($),{key:1,title:"Пользователи не найдены",icon:"heroicons:users",description:"Добавьте пользователей, чтобы увидеть их здесь."})):(l(),g(t(z),{key:2,users:t(s).users,pagination:t(s).pagination,"is-loading":t(s).isLoading,onPageChange:p},null,8,["users","pagination","is-loading"]))])])]}),_:1})}}});export{ne as default};
