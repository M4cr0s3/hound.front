import{c as L,a as U}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-CjAASZmf.js";import{_ as $}from"./EmptyState.vue_vue_type_script_setup_true_lang-BdG-MbLV.js";import{I as R}from"./client-D6K6htDN.js";import{R as g}from"./types-CpYKjTMI.js";import{d as k,i as B,K as S,j as m,o as l,u as t,B as M,w as f,b as n,e as v,n as N,t as P,k as I,m as T,p as V,g as j,a as b,F as D,l as F}from"./index-BJM9FpXo.js";import{u as w}from"./users-BNnsnLpB.js";import"./StacktraceViewer.vue_vue_type_style_index_0_scoped_7fdb99e3_lang-B8VJLqpg.js";import{_ as K}from"./Pagination.vue_vue_type_script_setup_true_lang-Dw2mOa6S.js";import"./index-B9uLu0-5.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./projects-CJzepl33.js";const z={class:"text-center"},E=k({__name:"UsersTable",props:{users:{},pagination:{},isLoading:{type:Boolean}},emits:["select","page-change"],setup(C,{emit:s}){var _,y;const p=s,o=w(),a=[{key:"name",title:"Имя"},{key:"email",title:"Почта"},{key:"role",title:"Роль"},{key:"actions",title:"Действия",visible:((y=(_=o.currentUser)==null?void 0:_.role)==null?void 0:y.title)===g.Maintainer}],h=B([{icon:"heroicons:clipboard",label:"Скопировать инвайт-ссылку",handler:e=>u(e),visible:e=>{var i;return(i=e.invitations)==null?void 0:i.length},key:""},{icon:"heroicons:trash",label:"Удалить",iconClass:"text-red-500",handler:e=>o.destroy(e.id),visible:e=>o.currentUser.id!==e.id,key:""}]),u=async e=>{var d;const i=new URL(window.location.origin),c=(d=e.invitations)==null?void 0:d.length;!e.invitations||!c||(i.pathname=`/invite/${e.invitations[c-1].token}`,await navigator.clipboard.writeText(i.toString()),S.success("Ссылка скопирована в буфер обмена"))},x=e=>{if(e){const i=new URL(e).searchParams.get("page");i&&p("page-change",i)}};return(e,i)=>{var c,d;return l(),m(t(K),{columns:a,data:e.users,pagination:e.pagination,"is-loading":e.isLoading,"row-clickable":"",onRowClick:i[0]||(i[0]=r=>p("select",r)),onPageChange:x,"row-class":"text-sm text-gray-700","pagination-text":"пользователей"},M({"cell-role":f(({value:r})=>[n("span",{class:N([{"bg-green-100 text-green-800":r.title===t(g).Maintainer,"bg-blue-100 text-blue-800":r.title===t(g).Developer},"px-2 inline-flex text-xs leading-5 font-semibold rounded-full"])},P(r.title),3)]),_:2},[((d=(c=t(o).currentUser)==null?void 0:c.role)==null?void 0:d.title)===t(g).Maintainer?{name:"cell-actions",fn:f(({row:r})=>[n("td",z,[v(t(L),{row:r,actions:h.value},null,8,["row","actions"])])]),key:"0"}:void 0]),1032,["data","pagination","is-loading"])}}}),q={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},A={class:"flex justify-between items-center mb-6"},G={class:"bg-white shadow rounded-lg"},H={key:0,class:"divide-y divide-gray-200"},ie=k({__name:"Index",setup(C){const s=w(),p=o=>{s.filters.page=Number(o),s.fetchUsers()};return I(async()=>{await s.fetchUsers()}),(o,a)=>{const h=V("RouterLink");return l(),m(U,null,{default:f(()=>{var u;return[n("div",q,[n("div",A,[a[1]||(a[1]=n("h1",{class:"text-2xl font-bold text-gray-900"},"Пользователи",-1)),((u=t(s).currentUser.role)==null?void 0:u.title)===t(g).Maintainer?(l(),m(h,{key:0,to:"/users/create",class:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},{default:f(()=>[v(t(R),{icon:"heroicons:plus",class:"-ml-1 mr-2 h-5 w-5"}),a[0]||(a[0]=j(" Добавить пользователя "))]),_:1,__:[0]})):T("",!0)]),n("div",G,[t(s).isLoading?(l(),b("ul",H,[(l(),b(D,null,F(5,x=>n("li",{key:`skeleton-${x}`,class:"px-4 py-4 sm:px-6"},a[2]||(a[2]=[n("div",{class:"flex items-center space-x-4 animate-pulse"},[n("div",{class:"flex-shrink-0 h-10 w-10 rounded-md bg-gray-200"}),n("div",{class:"flex-1 min-w-0 space-y-2"},[n("div",{class:"h-4 bg-gray-200 rounded w-3/4"}),n("div",{class:"h-3 bg-gray-100 rounded w-1/2"})])],-1)]))),64))])):!t(s).users.length&&!t(s).isLoading?(l(),m(t($),{key:1,title:"Пользователи не найдены",icon:"heroicons:users",description:"Добавьте пользователей, чтобы увидеть их здесь."})):(l(),m(t(E),{key:2,users:t(s).users,pagination:t(s).pagination,"is-loading":t(s).isLoading,onPageChange:p},null,8,["users","pagination","is-loading"]))])])]}),_:1})}}});export{ie as default};
