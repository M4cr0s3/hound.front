import{d as V,k as z,m as B,C as O,a as p,o as l,x as j,c as m,l as I,w as L,b as e,e as i,q as w,f as n,t as h,h as A,n as S,F,p as E}from"./index-uO5KFaZX.js";import{I as x}from"./iconify-DXTi0Chq.js";import{a as q}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-CyzJyrOO.js";import{u as P}from"./healthcheck-xp7eflYW.js";import{f as G}from"./index-BPW3n-1W.js";import"./CommentForm.vue_vue_type_style_index_0_scoped_8b816cc4_lang-BVKzazvO.js";import{_ as M}from"./Button.vue_vue_type_script_setup_true_lang-2hyEh9Zz.js";import{_ as J}from"./Badge.vue_vue_type_script_setup_true_lang-wmwZwCx6.js";import{_ as K}from"./EmptyState.vue_vue_type_script_setup_true_lang-DYhmhjEG.js";import"./index-Djch6Zjh.js";import{g as Q,k as U,i as W,L as X}from"./install-CjK4hi0Q.js";import{S as _}from"./StatCard-DTL7I5b5.js";import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-B-oPVFUC.js";import"./projects-Bqc3S0N-.js";import"./platforms-D8ztvdxx.js";const Z=V({__name:"ResponseTimeChart",props:{data:{type:Array,required:!0}},setup(k){const f=k,c=z(null);B(()=>{r()}),O(()=>f.data,()=>{r()});function r(){if(!c.value)return;Q(c.value)&&U(c.value);const u=W(c.value),y={tooltip:{trigger:"axis",formatter:d=>{const v=d[0];return`${v.axisValue}: ${v.value}ms`}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:f.data.map(d=>d.hour),axisLabel:{rotate:45}},yAxis:{type:"value",name:"Время ответа (ms)",axisLine:{show:!0}},series:[{name:"Время ответа",type:"line",smooth:!0,data:f.data.map(d=>d.avg_time),itemStyle:{color:"#4f46e5"},areaStyle:{color:new X(0,0,0,1,[{offset:0,color:"rgba(79, 70, 229, 0.3)"},{offset:1,color:"rgba(79, 70, 229, 0.1)"}])}}]};u.setOption(y),new ResizeObserver(()=>{u.resize()}).observe(c.value)}return(g,u)=>(l(),p("div",{ref_key:"chartRef",ref:c,class:"w-full h-full"},null,512))}}),ee={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},te={class:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4 mb-8"},se={class:"flex items-center space-x-3"},oe={class:"p-2 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-lg"},ae={key:0,class:"mt-2 flex items-center space-x-2"},re={class:"px-2 py-1 text-xs font-medium rounded bg-indigo-100 text-indigo-800"},ie={class:"text-sm text-gray-600 truncate max-w-md"},ne={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},le={class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden mb-8"},ce={class:"p-6 h-80"},de={class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"},ue={class:"divide-y divide-gray-100"},me={class:"flex items-center justify-between"},pe={class:"flex items-center space-x-4"},ve={class:"flex-shrink-0"},fe={class:"text-sm font-medium text-gray-900"},ge={class:"text-sm text-gray-500"},he={class:"flex items-center space-x-4"},xe=["onClick"],_e={key:0,class:"mt-3 p-3 bg-red-50 text-red-800 text-sm rounded-lg border border-red-100"},ye={class:"mt-1 break-words"},be=V({__name:"Results",setup(k){const f=j(),c=Number(f.params.endpointId),r=P(),g=m(()=>[...r.results].splice(0,20)),u=m(()=>r.stats),y=m(()=>r.isLoading),o=m(()=>r.chartData),d=m(()=>g.value[0]),v=z(null),D=m(()=>{if(!o.value||o.value.length<2)return null;const a=o.value[0].response_time,t=o.value[o.value.length-1].response_time;return t>a?"up":t<a?"down":null}),N=m(()=>{if(!o.value||o.value.length<2)return null;const a=o.value[0].response_time;return`${((o.value[o.value.length-1].response_time-a)/a*100).toFixed(2)}%`}),H=a=>{if(!a.success){const t=a.error_message||`HTTP ${a.status_code}`;navigator.clipboard.writeText(t),v.value=a.id,setTimeout(()=>v.value=null,2e3)}};return B(async()=>{await r.fetchEndpointResults(c)}),(a,t)=>(l(),I(q,null,{default:L(()=>{var b,C,T,$,R;return[e("div",ee,[e("div",te,[e("div",null,[e("div",se,[e("div",oe,[i(n(x),{icon:"heroicons:heart",class:"h-6 w-6 text-white"})]),t[1]||(t[1]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Health Check Мониторинг",-1))]),n(r).endpoint?(l(),p("div",ae,[e("span",re,h(n(r).endpoint.method),1),e("p",ie,h(n(r).endpoint.url),1)])):w("",!0)]),i(n(M),{onClick:t[0]||(t[0]=s=>a.$router.back()),variant:"outline",class:"self-start sm:self-center"},{default:L(()=>[i(n(x),{icon:"heroicons:arrow-left",class:"mr-2 h-4 w-4"}),t[2]||(t[2]=A(" Назад "))]),_:1,__:[2]})]),e("div",ne,[i(_,{title:"Ср. время ответа",value:`${((b=u.value)==null?void 0:b.avg_response_time.toFixed(2))??0}ms`,icon:"heroicons:clock",trend:D.value,"trend-value":N.value},null,8,["value","trend","trend-value"]),i(_,{title:"Аптайм",value:`${((C=u.value)==null?void 0:C.uptime_percentage.toFixed(2))??100}%`,icon:"heroicons:shield-check",variant:"success"},null,8,["value"]),i(_,{title:"Всего проверок",value:((T=u.value)==null?void 0:T.total_checks)??0,icon:"heroicons:check-badge",variant:"primary"},null,8,["value"]),i(_,{title:"Последний статус",value:(($=d.value)==null?void 0:$.status_code)??"-",variant:(R=d.value)!=null&&R.success?"success":"danger",icon:"heroicons:exclamation-circle"},null,8,["value","variant"])]),e("div",le,[t[3]||(t[3]=e("div",{class:"px-6 py-5 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white"},[e("h2",{class:"text-lg font-semibold text-gray-900"},"Время ответа (последние 24 часа)")],-1)),e("div",ce,[i(Z,{data:o.value},null,8,["data"])])]),e("div",de,[t[6]||(t[6]=e("div",{class:"px-6 py-5 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white"},[e("h2",{class:"text-lg font-semibold text-gray-900"},"История проверок")],-1)),e("div",ue,[y.value?(l(),p(F,{key:0},S(5,s=>e("div",{key:s,class:"p-6"},t[4]||(t[4]=[e("div",{class:"animate-pulse flex space-x-4"},[e("div",{class:"flex-1 space-y-4 py-1"},[e("div",{class:"h-4 bg-gray-100 rounded w-3/4"}),e("div",{class:"space-y-2"},[e("div",{class:"h-4 bg-gray-100 rounded"})])])],-1)]))),64)):g.value.length===0?(l(),I(n(K),{key:1,title:"Нет данных",icon:"heroicons:inbox",description:"Здесь будут отображаться результаты проверок",class:"p-8"})):(l(!0),p(F,{key:2},S(g.value,s=>(l(),p("div",{key:s.id,class:"p-5 hover:bg-gray-50 transition-colors duration-150"},[e("div",me,[e("div",pe,[e("div",ve,[e("div",{class:E(["h-10 w-10 rounded-full flex items-center justify-center",s.success?"bg-green-100 text-green-600":"bg-red-100 text-red-600"])},[i(n(x),{icon:s.success?"heroicons:check":"heroicons:x-mark",class:"h-5 w-5"},null,8,["icon"])],2)]),e("div",null,[e("p",fe,h(n(G)(s.created_at)),1),e("p",ge,h(s.response_time.toFixed(2))+" ms ",1)])]),e("div",he,[i(n(J),{variant:s.success?"success":"danger",text:`HTTP ${s.status_code}`},null,8,["variant","text"]),s.success?w("",!0):(l(),p("button",{key:0,onClick:we=>H(s),class:"text-gray-400 hover:text-gray-600",title:"Копировать ошибку"},[i(n(x),{icon:"heroicons:clipboard",class:"h-5 w-5"})],8,xe))])]),!s.success&&v.value===s.id?(l(),p("div",_e,[t[5]||(t[5]=e("p",{class:"font-medium"},"Ошибка:",-1)),e("p",ye,h(s.error_message||"Нет описания ошибки"),1)])):w("",!0)]))),128))])])])]}),_:1}))}}),je=Y(be,[["__scopeId","data-v-15c330ce"]]);export{je as default};
