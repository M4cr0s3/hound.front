import{d as k,a as _,o as d,b as e,e as n,f as i,t as u,q as L,w as l,s as V,p as z,h as f,j as N,k as w,m as W,B as G,C as O,l as b,i as F,x as J,n as B,F as M,g as K}from"./index-DmyUZq0U.js";import{a as Q,M as H}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-BwL1_S68.js";import{I as p}from"./iconify-DK_FkkOf.js";import{_ as X}from"./SelectField.vue_vue_type_script_setup_true_lang-DpHE4pZ1.js";import{_ as P}from"./InputField.vue_vue_type_script_setup_true_lang-UkiDE7Dv.js";import{_ as E}from"./Button.vue_vue_type_script_setup_true_lang-BZBZpZNp.js";import"./index-BCqgpTI_.js";import{_ as I}from"./Badge.vue_vue_type_script_setup_true_lang-BCFXyg7k.js";import{P as Y}from"./platforms-D8ztvdxx.js";import{_ as q}from"./EmptyState.vue_vue_type_script_setup_true_lang-ybUaClyj.js";import{f as D}from"./index-FUb4nFco.js";import{S}from"./StatCard-Be6Cc0SQ.js";import{u as Z,i as ee,a as te,b as se,c as oe,d as ne,e as ie,f as ae,h as re,j as le}from"./install-w9194OeT.js";import"./index-DCK61lqv.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./projects-Deqezav3.js";import"./form-BhL115Ha.js";const de={class:"px-5 py-4 hover:bg-gray-50 transition-colors duration-150"},ce={class:"flex items-start space-x-3"},ue={class:"flex-shrink-0 pt-0.5"},me={class:"min-w-0 flex-1"},pe={class:"text-sm font-medium text-gray-900"},ve={class:"mt-1 flex items-center space-x-3"},ge={class:"text-xs text-gray-500"},fe={key:0,class:"text-xs px-2 py-0.5 bg-gray-100 text-gray-800 rounded"},he=k({__name:"IssueItem",props:{issue:{type:Object,required:!0},projectSlug:{type:String,required:!0}},setup(m){const o=s=>({open:"primary",in_progress:"warning",resolved:"success",closed:"secondary"})[s]||"default",v=s=>({open:"Открыта",in_progress:"В работе",resolved:"Решена",closed:"Закрыта"})[s]||s;return(s,g)=>{const h=V("RouterLink");return d(),_("div",de,[e("div",ce,[e("div",ue,[n(i(I),{variant:o(m.issue.status),text:v(m.issue.status)},null,8,["variant","text"])]),e("div",me,[e("p",pe,u(m.issue.title),1),e("div",ve,[e("span",ge,u(i(D)(m.issue.created_at)),1),m.issue.event?(d(),_("span",fe,u(m.issue.event.level),1)):L("",!0)])]),n(h,{to:`/issues/${m.issue.id}`,class:"text-gray-400 hover:text-gray-500"},{default:l(()=>[n(i(p),{icon:"heroicons:chevron-right",class:"h-5 w-5"})]),_:1},8,["to"])])])}}}),xe={class:"px-5 py-4 hover:bg-gray-50 transition-colors duration-150"},ye={class:"flex items-center justify-between"},_e={class:"flex items-center space-x-3 min-w-0"},be={class:"min-w-0"},we={class:"mt-1 flex items-center space-x-3"},$e={class:"text-xs text-gray-500"},ke={class:"text-xs text-gray-500"},je={class:"flex items-center space-x-4"},Ce=k({__name:"EndpointItem",props:{endpoint:{}},emits:["delete"],setup(m){return(o,v)=>{const s=V("RouterLink");return d(),_("div",xe,[e("div",ye,[e("div",_e,[e("div",{class:z(["flex-shrink-0",{"text-green-500":o.endpoint.is_active,"text-red-500":!o.endpoint.is_active}])},[n(i(p),{icon:o.endpoint.is_active?"heroicons:check-circle":"heroicons:x-circle",class:"h-5 w-5"},null,8,["icon"])],2),e("div",be,[n(s,{to:`/healthcheck/${o.endpoint.id}/results`,class:"text-sm font-medium text-gray-900 truncate"},{default:l(()=>[f(u(o.endpoint.url),1)]),_:1},8,["to"]),e("div",we,[e("span",$e," HTTP "+u(o.endpoint.expected_status),1),e("span",ke," Каждые "+u(o.endpoint.interval)+" мин ",1)])])]),e("div",je,[e("button",{onClick:v[0]||(v[0]=N(g=>o.$emit("delete",o.endpoint.id),["stop"])),class:"text-gray-400 hover:text-red-500"},[n(i(p),{icon:"heroicons:trash",class:"h-4 w-4 cursor-pointer"})])])])])}}}),Ee={class:"px-5 py-4 hover:bg-gray-50 transition-colors duration-150"},Se={class:"flex items-start space-x-3"},Le={class:"min-w-0 flex-1"},Ve={class:"text-sm font-medium text-gray-900 truncate"},Te={class:"mt-1 flex flex-wrap items-center gap-x-3 gap-y-1"},Re={class:"text-xs text-gray-500"},Fe=k({__name:"EventItem",props:{event:{},projectSlug:{}},setup(m){return(o,v)=>{const s=V("RouterLink");return d(),_("div",Ee,[e("div",Se,[e("div",{class:z(["flex-shrink-0 mt-1",{"text-red-500":o.event.level==="error"||o.event.level==="critical","text-amber-500":o.event.level==="warning","text-gray-500":o.event.level==="info"}])},[n(i(p),{icon:{critical:"heroicons:exclamation-triangle",error:"heroicons:exclamation-circle",warning:"heroicons:exclamation-circle",info:"heroicons:information-circle"}[o.event.level],class:"h-5 w-5"},null,8,["icon"])],2),e("div",Le,[e("p",Ve,u(o.event.message),1),e("div",Te,[e("span",Re,u(i(D)(o.event.created_at)),1),e("span",{class:z(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",{"bg-red-100 text-red-800":o.event.level==="error"||o.event.level==="critical","bg-amber-100 text-amber-800":o.event.level==="warning","bg-blue-100 text-blue-800":o.event.level==="info"}])},u(o.event.level),3)])]),n(s,{to:`/events/${o.event.id}`,class:"text-gray-400 hover:text-gray-500"},{default:l(()=>[n(i(p),{icon:"heroicons:chevron-right",class:"h-5 w-5"})]),_:1},8,["to"])])])}}}),Be=k({__name:"LineChart",props:{data:{type:Array,required:!0},title:{type:String,default:""}},setup(m){Z([te,se,oe,ne,ie,ae,re,le]);const o=m,v=w(null);let s=null;const g=()=>{v.value&&(s=ee(v.value),h())},h=()=>{if(!s)return;const y=Math.max(...o.data.map(a=>a.total)),c=Math.ceil(y*1.2),T=o.data.map(a=>a.date),j=o.data.map(a=>a.errors),R=o.data.map(a=>a.warnings),C={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:a=>{const t=a[0].data;return`
          <div class="text-gray-900 font-medium">${a[0].axisValue}</div>
          <div class="mt-2 space-y-1">
            <div class="flex items-center">
              <span class="inline-block w-3 h-3 rounded-full mr-2 bg-[#6366F1]"></span>
              <span>Всего: <strong>${t.total}</strong></span>
            </div>
            <div class="flex items-center">
              <span class="inline-block w-3 h-3 rounded-full mr-2 bg-[#EF4444]"></span>
              <span>Ошибки: <strong>${t.errors}</strong></span>
            </div>
            <div class="flex items-center">
              <span class="inline-block w-3 h-3 rounded-full mr-2 bg-[#F59E0B]"></span>
              <span>Предупреждения: <strong>${t.warnings}</strong></span>
            </div>
          </div>
        `}},legend:{data:["Всего","Ошибки","Предупреждения"],bottom:0},grid:{left:"3%",right:"4%",bottom:"15%",top:o.title?"10%":"5%",containLabel:!0},xAxis:{type:"category",data:T,axisLine:{lineStyle:{color:"#E5E7EB"}},axisLabel:{color:"#6B7280"}},yAxis:{max:c,type:"value",axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"#F3F4F6"}},axisLabel:{color:"#6B7280"}},series:[{name:"Всего",type:"bar",barWidth:"60%",itemStyle:{color:"#6366F1",borderRadius:[12,12,0,0]},data:o.data.map(a=>({value:a.total,total:a.total,errors:a.errors,warnings:a.warnings}))},{name:"Ошибки",type:"line",smooth:!0,symbolSize:8,lineStyle:{width:3,color:"#EF4444"},itemStyle:{color:"#EF4444",borderWidth:2,borderColor:"#fff"},data:j},{name:"Предупреждения",type:"line",smooth:!0,symbolSize:8,lineStyle:{width:3,color:"#F59E0B"},itemStyle:{color:"#F59E0B",borderWidth:2,borderColor:"#fff"},data:R}],...o.title&&{title:{text:o.title,left:"center",textStyle:{color:"#111827",fontWeight:"normal",fontSize:14}}}};s.setOption(C)},x=()=>{s==null||s.resize()};return W(()=>{g(),window.addEventListener("resize",x)}),G(()=>{window.removeEventListener("resize",x),s==null||s.dispose()}),O(()=>o.data,()=>{h()},{deep:!0}),O(()=>o.color,()=>{h()}),(y,c)=>(d(),_("div",{ref_key:"chartRef",ref:v,class:"w-full h-[300px]"},null,512))}}),Me={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8"},Pe={class:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4"},qe={class:"flex items-start space-x-4"},ze={class:"p-3 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-xl shadow-md"},Ie={class:"text-2xl font-bold text-gray-900"},Ue={class:"flex flex-wrap items-center gap-2 mt-2"},Ae={class:"flex space-x-3"},Oe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},He={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Ne={class:"lg:col-span-2 space-y-6"},We={class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"},De={class:"p-6"},Ge={class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"},Je={class:"px-6 py-5 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white flex items-center justify-between"},Ke={class:"divide-y divide-gray-100"},Qe={class:"space-y-6"},Xe={class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"},Ye={class:"px-6 py-5 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white flex items-center justify-between"},Ze={class:"divide-y divide-gray-100"},et={class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"},tt={class:"px-6 py-5 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white flex items-center justify-between"},st={class:"divide-y divide-gray-100"},ot={class:"text-center"},nt={class:"mt-2 text-sm text-gray-500"},it={class:"flex justify-end gap-3"},at={class:"flex justify-end gap-3"},kt=k({__name:"Show",setup(m){const o=J(),v=K(),s=w({id:0,name:"",slug:"",platform:"",team:{name:""},events:[],issues:[],endpoints:[],notificationRules:[]}),g=w({events_today:0,events_week:0,active_issues:0,uptime_percentage:100}),h=w([]),x=w(!1),y=w(!1),c=w({url:"",expected_status:200,interval:5,method:"GET",is_active:!0}),T=a=>{var t;return(t=Y.find($=>$.name===a))==null?void 0:t.icon},j=async()=>{try{const a=await F.get(`/projects/${o.params.slug}`);s.value=a.project,g.value=a.stats,h.value=a.daily_stats}catch(a){console.error("Error fetching project:",a)}},R=async()=>{try{await F.delete(`/projects/${s.value.id}`),await v.push("/projects")}catch(a){console.error("Error deleting project:",a)}finally{x.value=!1}},C=async()=>{try{await F.post(`/healthcheck/${s.value.slug}`,c.value),await j(),y.value=!1,c.value={url:"",expected_status:200,interval:5,method:"GET",is_active:!0}}catch(a){console.error("Error adding endpoint:",a)}};return W(()=>{j()}),(a,t)=>{const $=V("RouterLink");return d(),b(Q,null,{default:l(()=>{var U,A;return[e("div",Me,[e("div",Pe,[e("div",qe,[e("div",ze,[n(i(p),{icon:T(s.value.platform),class:"h-8 w-8 text-white"},null,8,["icon"])]),e("div",null,[e("h1",Ie,u(s.value.name),1),e("div",Ue,[n(i(I),{variant:"primary",class:"flex items-center"},{default:l(()=>[n(i(p),{icon:"heroicons:user-group",class:"mr-1 h-4 w-4"}),f(" "+u(s.value.team.name),1)]),_:1}),n(i(I),{variant:"secondary",class:"flex items-center"},{default:l(()=>[n(i(p),{icon:"heroicons:computer-desktop",class:"mr-1 h-4 w-4"}),f(" "+u(s.value.platform),1)]),_:1})])])]),e("div",Ae,[n($,{to:`/projects/${s.value.slug}/settings/general`,class:"inline-flex items-center px-4 py-2 bg-white border border-gray-200 text-gray-700 text-sm font-medium rounded-lg shadow-sm hover:bg-gray-50 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"},{default:l(()=>[n(i(p),{icon:"heroicons:cog-6-tooth",class:"mr-2 h-4 w-4"}),t[10]||(t[10]=f(" Настройки "))]),_:1},8,["to"]),e("button",{onClick:t[0]||(t[0]=r=>x.value=!0),class:"inline-flex items-center px-4 py-2 cursor-pointer bg-white border border-gray-200 text-red-600 text-sm font-medium rounded-lg shadow-sm hover:bg-red-50 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2"},[n(i(p),{icon:"heroicons:trash",class:"mr-2 h-4 w-4"}),t[11]||(t[11]=f(" Удалить "))])])]),e("div",Oe,[n(S,{title:"Событий сегодня",value:g.value.events_today,icon:"heroicons:bell-alert"},null,8,["value"]),n(S,{title:"Событий за неделю",value:g.value.events_week,icon:"heroicons:calendar-days"},null,8,["value"]),n(S,{title:"Активных задач",value:g.value.active_issues,icon:"heroicons:exclamation-triangle",variant:"warning"},null,8,["value"]),n(S,{title:"Uptime",value:`${(A=(U=g.value)==null?void 0:U.uptime_percentage)==null?void 0:A.toFixed(2)}%`,icon:"heroicons:shield-check",variant:"success"},null,8,["value"])]),e("div",He,[e("div",Ne,[e("div",We,[t[12]||(t[12]=e("div",{class:"px-6 py-5 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white"},[e("h2",{class:"text-lg font-semibold text-gray-900"},"Активность (7 дней)")],-1)),e("div",De,[n(Be,{data:h.value,title:"Активность событий",color:"#8B5CF6","show-mark-line":!0},null,8,["data"])])]),e("div",Ge,[e("div",Je,[t[14]||(t[14]=e("h2",{class:"text-lg font-semibold text-gray-900"},"Последние события",-1)),n($,{to:`/projects/${s.value.slug}/events`,class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"},{default:l(()=>t[13]||(t[13]=[f(" Показать все ")])),_:1},8,["to"])]),e("div",Ke,[(d(!0),_(M,null,B(s.value.events,r=>(d(),b(Fe,{key:r.id,event:r,class:"hover:bg-gray-50 transition-colors duration-150","project-slug":s.value.slug},null,8,["event","project-slug"]))),128)),s.value.events.length?L("",!0):(d(),b(i(q),{key:0,title:"Событий не найдено",icon:"heroicons:bell",description:"Здесь будут отображаться последние события вашего проекта.",class:"p-6",small:""}))])])]),e("div",Qe,[e("div",Xe,[e("div",Ye,[t[15]||(t[15]=e("h2",{class:"text-lg font-semibold text-gray-900"},"Health Check Endpoints",-1)),e("button",{onClick:t[1]||(t[1]=r=>y.value=!0),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium cursor-pointer"},[n(i(p),{icon:"heroicons:plus",class:"h-4 w-4"})])]),e("div",Ze,[(d(!0),_(M,null,B(s.value.endpoints,r=>(d(),b(Ce,{slug:s.value.slug,key:r.id,endpoint:r,class:"hover:bg-gray-50 transition-colors duration-150"},null,8,["slug","endpoint"]))),128)),s.value.endpoints.length?L("",!0):(d(),b(i(q),{key:0,title:"Нет endpoints",icon:"heroicons:link",description:"Добавьте health check endpoints для мониторинга.",class:"p-6",small:""}))])]),e("div",et,[e("div",tt,[t[17]||(t[17]=e("h2",{class:"text-lg font-semibold text-gray-900"},"Последние проблемы",-1)),n($,{to:`/projects/${s.value.slug}/issues`,class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"},{default:l(()=>t[16]||(t[16]=[f(" Показать все ")])),_:1},8,["to"])]),e("div",st,[(d(!0),_(M,null,B(s.value.issues,r=>(d(),b(he,{key:r.id,issue:r,class:"hover:bg-gray-50 transition-colors duration-150","project-slug":s.value.slug},null,8,["issue","project-slug"]))),128)),s.value.issues.length?L("",!0):(d(),b(i(q),{key:0,title:"Проблем не найдено",icon:"heroicons:check-badge",description:"Отличная работа! Активных проблем нет.",class:"p-6",small:""}))])])])])]),n(i(H),{"is-open":x.value,onClose:t[3]||(t[3]=r=>x.value=!1),title:"Подтверждение удаления"},{content:l(()=>[e("div",ot,[n(i(p),{icon:"heroicons:exclamation-triangle",class:"mx-auto h-12 w-12 text-red-500"}),t[19]||(t[19]=e("h3",{class:"mt-2 text-lg font-medium text-gray-900"},"Удалить проект?",-1)),e("div",nt,[e("p",null,'Вы уверены, что хотите удалить проект "'+u(s.value.name)+'"?',1),t[18]||(t[18]=e("p",{class:"mt-1"},"Это действие нельзя отменить.",-1))])])]),footer:l(()=>[e("div",it,[n(i(E),{variant:"secondary",onClick:t[2]||(t[2]=r=>x.value=!1)},{default:l(()=>t[20]||(t[20]=[f(" Отмена ")])),_:1}),n(i(E),{variant:"danger",onClick:R},{default:l(()=>t[21]||(t[21]=[f(" Удалить ")])),_:1})])]),_:1},8,["is-open"]),n(i(H),{"is-open":y.value,onClose:t[9]||(t[9]=r=>y.value=!1),title:"Добавить Health Check Endpoint"},{content:l(()=>[e("form",{onSubmit:N(C,["prevent"]),class:"space-y-4"},[n(i(P),{id:"endpoint-url",modelValue:c.value.url,"onUpdate:modelValue":t[4]||(t[4]=r=>c.value.url=r),label:"URL Endpoint",placeholder:"https://example.com/health",required:"",icon:"heroicons:link"},null,8,["modelValue"]),n(i(P),{id:"exp-status",modelValue:c.value.expected_status,"onUpdate:modelValue":t[5]||(t[5]=r=>c.value.expected_status=r),label:"Ожидаемый HTTP статус",type:"number",placeholder:"200",required:"",icon:"heroicons:hashtag"},null,8,["modelValue"]),n(i(P),{modelValue:c.value.interval,"onUpdate:modelValue":t[6]||(t[6]=r=>c.value.interval=r),label:"Интервал проверки (минуты)",type:"number",placeholder:"5",required:"",icon:"heroicons:clock",id:"check-interval"},null,8,["modelValue"]),n(i(X),{options:["GET","POST","PUT","PATCH","OPTIONS"],modelValue:c.value.method,"onUpdate:modelValue":t[7]||(t[7]=r=>c.value.method=r),label:"Метод",required:""},null,8,["modelValue"])],32)]),footer:l(()=>[e("div",at,[n(i(E),{variant:"secondary",onClick:t[8]||(t[8]=r=>y.value=!1)},{default:l(()=>t[22]||(t[22]=[f(" Отмена ")])),_:1}),n(i(E),{onClick:C},{default:l(()=>t[23]||(t[23]=[f(" Добавить ")])),_:1})])]),_:1},8,["is-open"])]}),_:1})}}});export{kt as default};
