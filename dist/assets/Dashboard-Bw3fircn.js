import{I as D}from"./iconify-DK_FkkOf.js";import{d as v,k as y,c as b,m as w,i as $,a as n,o,F as g,n as h,b as e,p,e as c,f as _,t as l,q as L,h as k,l as C,s as I,w as x}from"./index-DmyUZq0U.js";import{g as R,f as F}from"./index-FUb4nFco.js";import{_ as P}from"./EmptyState.vue_vue_type_script_setup_true_lang-ybUaClyj.js";import"./index-BCqgpTI_.js";import{u as S,_ as B,a as N}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-BwL1_S68.js";import{P as V}from"./platforms-D8ztvdxx.js";import"./index-DCK61lqv.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./projects-Deqezav3.js";const M={class:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4 mb-6"},T={class:"px-4 py-5 sm:p-6"},j={class:"flex items-center"},q={class:"ml-5 w-0 flex-1"},z={class:"text-sm font-medium text-gray-500 truncate"},A={class:"flex items-baseline"},E={class:"text-2xl font-semibold text-gray-900"},O={class:"sr-only"},G=v({__name:"DashboardStats",setup(f){const t=y({total_events:{value:0,change_percentage:null},unresolved_issues:{value:0,change_percentage:null},resolved_issues:{value:0,change_percentage:null},closed_issues:{value:0,change_percentage:null}}),d=b(()=>[{name:"Всего событий",value:t.value.total_events.value,change:t.value.total_events.change_percentage,bgColor:"bg-blue-500",icon:"heroicons:calendar"},{name:"Нерешенные задачи",value:t.value.unresolved_issues.value,change:t.value.unresolved_issues.change_percentage,bgColor:"bg-yellow-500",icon:"heroicons:exclamation-triangle"},{name:"Решенные задачи",value:t.value.resolved_issues.value,change:t.value.resolved_issues.change_percentage,bgColor:"bg-green-500",icon:"heroicons:check-circle"},{name:"Закрытые задачи",value:t.value.closed_issues.value,change:t.value.closed_issues.change_percentage,bgColor:"bg-gray-500",icon:"heroicons:lock-closed"}]);return w(async()=>{try{const i=await $.get("/events/dashboard");t.value={...t.value,...i}}catch(i){console.error("Failed to load dashboard stats",i)}}),(i,r)=>(o(),n("div",M,[(o(!0),n(g,null,h(d.value,s=>(o(),n("div",{key:s.name,class:"bg-white overflow-hidden shadow rounded-lg"},[e("div",T,[e("div",j,[e("div",{class:p(["flex-shrink-0 rounded-md p-3",s.bgColor])},[c(_(D),{icon:s.icon,class:"h-6 w-6 text-white"},null,8,["icon"])],2),e("div",q,[e("dt",z,l(s.name),1),e("dd",A,[e("div",E,l(s.value),1),typeof s.change=="number"?(o(),n("div",{key:0,class:p([s.change>=0?"text-green-600":"text-red-600","ml-2 flex items-baseline text-sm font-semibold"])},[e("span",O,l(s.change>=0?"Increased":"Decreased")+" by ",1),k(" "+l(Math.abs(s.change).toFixed(2))+"% ",1)],2)):L("",!0)])])])])]))),128))]))}}),H={class:"bg-white shadow rounded-lg mb-6"},J={key:0,class:"bg-white overflow-hidden"},K={class:"divide-y divide-gray-200"},Q={class:"px-4 py-4 sm:px-6"},U={class:"flex items-center justify-between"},W={class:"text-sm font-medium text-indigo-600 truncate"},X={class:"ml-2 flex-shrink-0 flex"},Y={class:"mt-2 sm:flex sm:justify-between"},Z={class:"sm:flex"},ee={class:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0"},se={class:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0"},te={class:"px-4 py-4 sm:px-6 border-t border-gray-200"},ae=v({__name:"DashboardIssues",setup(f){const t=y([]),d=r=>{switch(r){case"open":return"bg-yellow-100 text-yellow-800";case"resolved":return"bg-green-100 text-green-800";case"in_progress":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},i=b(()=>t.value.length?t.value.map(r=>({...r,statusClass:d(r.status),status:R(r.status)})):[]);return w(async()=>{t.value=await $.get("/issues/dashboard")}),(r,s)=>{const u=I("RouterLink");return o(),n("div",H,[s[1]||(s[1]=e("div",{class:"px-4 py-5 sm:px-6 border-b border-gray-200"},[e("h3",{class:"text-lg leading-6 font-medium text-gray-900"}," Недавние задачи ")],-1)),i.value.length?(o(),n("div",J,[e("ul",K,[(o(!0),n(g,null,h(i.value,a=>(o(),n("li",{key:a.id},[c(u,{to:`/issues/${a.id}`,class:"block hover:bg-gray-50"},{default:x(()=>{var m;return[e("div",Q,[e("div",U,[e("p",W,l(a.title),1),e("div",X,[e("p",{class:p(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",a.statusClass])},l(a.status),3)])]),e("div",Y,[e("div",Z,[e("p",ee,l((m=a.event)==null?void 0:m.project.name),1)]),e("div",se,l(_(F)(a.created_at)),1)])])]}),_:2},1032,["to"])]))),128))])])):(o(),C(_(P),{key:1,title:"Задачи отсутствуют",icon:"heroicons:document-text",description:"Все выполнено! Либо пока что не время..."})),e("div",te,[c(u,{to:"/issues",class:"cursor-pointer text-sm font-medium text-indigo-600 hover:text-indigo-500"},{default:x(()=>s[0]||(s[0]=[k(" Посмотреть все задачи ")])),_:1})])])}}}),oe={class:"bg-white shadow rounded-lg"},ne={class:"bg-white overflow-hidden rounded-bl-lg rounded-br-lg"},le={class:"min-w-full divide-y divide-gray-200"},re={class:"bg-white divide-y divide-gray-200"},ie={class:"px-6 py-4 whitespace-nowrap"},ce={class:"flex items-center"},de={class:"ml-4"},ue={class:"text-sm font-medium text-gray-900"},me={class:"text-sm text-gray-500"},_e={class:"px-6 py-4 whitespace-nowrap"},ge={class:"text-sm text-gray-900"},he={class:"text-sm text-gray-500"},pe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},xe={class:"flex -space-x-2"},ve={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},fe=v({__name:"DashboardProjects",setup(f){const t=y([]),d=b(()=>t.value.length?t.value.map(r=>{var s;return{...r,icon:((s=V.find(u=>u.name===r.platform))==null?void 0:s.icon)||"",bgColor:S()}}):[]),i=async()=>{t.value=await $.get("/projects/dashboard")};return w(async()=>{await i()}),(r,s)=>{const u=I("RouterLink");return o(),n("div",oe,[s[2]||(s[2]=e("div",{class:"px-4 py-5 sm:px-6 border-b border-gray-200"},[e("h3",{class:"text-lg leading-6 font-medium text-gray-900"},"Ваши проекты")],-1)),e("div",ne,[e("table",le,[s[1]||(s[1]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Проект "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Задачи (24ч) "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Команда "),e("th",{scope:"col",class:"relative px-6 py-3"},[e("span",{class:"sr-only"},"Редактировать")])])],-1)),e("tbody",re,[(o(!0),n(g,null,h(d.value,a=>(o(),n("tr",{key:a.id,class:"hover:bg-gray-50"},[e("td",ie,[e("div",ce,[e("div",{class:p(["flex-shrink-0 h-10 w-10 rounded-md flex items-center justify-center",a.bgColor])},[c(_(D),{icon:a.icon,class:"h-6 w-6 text-white"},null,8,["icon"])],2),e("div",de,[e("div",ue,l(a.name),1),e("div",me,l(a.platform),1)])])]),e("td",_e,[e("div",ge,l(a.issues),1),e("div",he,l(a.resolved)+" решено ",1)]),e("td",pe,[e("div",xe,[(o(!0),n(g,null,h(a.team.members,m=>(o(),C(_(B),{key:m.id,name:m.name},null,8,["name"]))),128))])]),e("td",ve,[c(u,{to:`/projects/${a.slug}/settings/general`,class:"text-indigo-600 hover:text-indigo-900"},{default:x(()=>s[0]||(s[0]=[k(" Настройки ")])),_:2},1032,["to"])])]))),128))])])])])}}}),Fe=v({__name:"Dashboard",setup(f){return(t,d)=>(o(),C(N,null,{default:x(()=>[c(G),c(ae),c(fe)]),_:1}))}});export{Fe as default};
