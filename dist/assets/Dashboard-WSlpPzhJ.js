import{I}from"./iconify-e9sR0ZFq.js";import{d as v,k as y,c as b,m as w,i as $,a as n,o,F as g,n as h,b as e,p,e as c,f as _,t as l,q as R,h as k,l as C,s as L,w as x}from"./index-B605mWSS.js";import{g as F,f as P}from"./index-BPW3n-1W.js";import{_ as S}from"./EmptyState.vue_vue_type_script_setup_true_lang-6tWArOav.js";import{u as B,_ as N,a as V}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-BKjXbmz5.js";import"./StacktraceViewer.vue_vue_type_style_index_0_scoped_8568d111_lang-OogGfIpQ.js";import{P as M}from"./platforms-D8ztvdxx.js";import"./index-p83CCQy-.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./projects-DhOs14FM.js";const T={class:"grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4 mb-6"},j={class:"px-4 py-5 sm:p-6"},q={class:"flex items-center"},z={class:"ml-5 w-0 flex-1"},A={class:"text-sm font-medium text-gray-500 truncate"},E={class:"flex items-baseline"},O={class:"text-2xl font-semibold text-gray-900"},G={class:"sr-only"},H=v({__name:"DashboardStats",setup(f){const t=y({total_events:{value:0,change_percentage:null},unresolved_issues:{value:0,change_percentage:null},resolved_issues:{value:0,change_percentage:null},closed_issues:{value:0,change_percentage:null}}),d=b(()=>[{name:"Всего событий",value:t.value.total_events.value,change:t.value.total_events.change_percentage,bgColor:"bg-blue-500",icon:"heroicons:calendar"},{name:"Нерешенные задачи",value:t.value.unresolved_issues.value,change:t.value.unresolved_issues.change_percentage,bgColor:"bg-yellow-500",icon:"heroicons:exclamation-triangle"},{name:"Решенные задачи",value:t.value.resolved_issues.value,change:t.value.resolved_issues.change_percentage,bgColor:"bg-green-500",icon:"heroicons:check-circle"},{name:"Закрытые задачи",value:t.value.closed_issues.value,change:t.value.closed_issues.change_percentage,bgColor:"bg-gray-500",icon:"heroicons:lock-closed"}]);return w(async()=>{try{const i=await $.get("/events/dashboard");t.value={...t.value,...i}}catch(i){console.error("Failed to load dashboard stats",i)}}),(i,r)=>(o(),n("div",T,[(o(!0),n(g,null,h(d.value,s=>(o(),n("div",{key:s.name,class:"bg-white overflow-hidden shadow rounded-lg"},[e("div",j,[e("div",q,[e("div",{class:p(["flex-shrink-0 rounded-md p-3",s.bgColor])},[c(_(I),{icon:s.icon,class:"h-6 w-6 text-white"},null,8,["icon"])],2),e("div",z,[e("dt",A,l(s.name),1),e("dd",E,[e("div",O,l(s.value),1),typeof s.change=="number"?(o(),n("div",{key:0,class:p([s.change>=0?"text-green-600":"text-red-600","ml-2 flex items-baseline text-sm font-semibold"])},[e("span",G,l(s.change>=0?"Increased":"Decreased")+" by ",1),k(" "+l(Math.abs(s.change).toFixed(2))+"% ",1)],2)):R("",!0)])])])])]))),128))]))}}),J={class:"bg-white shadow rounded-lg mb-6"},K={key:0,class:"bg-white overflow-hidden"},Q={class:"divide-y divide-gray-200"},U={class:"px-4 py-4 sm:px-6"},W={class:"flex items-center justify-between"},X={class:"text-sm font-medium text-indigo-600 truncate"},Y={class:"ml-2 flex-shrink-0 flex"},Z={class:"mt-2 sm:flex sm:justify-between"},ee={class:"sm:flex"},se={class:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0"},te={class:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0"},ae={class:"px-4 py-4 sm:px-6 border-t border-gray-200"},oe=v({__name:"DashboardIssues",setup(f){const t=y([]),d=r=>{switch(r){case"open":return"bg-yellow-100 text-yellow-800";case"resolved":return"bg-green-100 text-green-800";case"in_progress":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},i=b(()=>t.value.length?t.value.map(r=>({...r,statusClass:d(r.status),status:F(r.status)})):[]);return w(async()=>{t.value=await $.get("/issues/dashboard")}),(r,s)=>{const u=L("RouterLink");return o(),n("div",J,[s[1]||(s[1]=e("div",{class:"px-4 py-5 sm:px-6 border-b border-gray-200"},[e("h3",{class:"text-lg leading-6 font-medium text-gray-900"}," Недавние задачи ")],-1)),i.value.length?(o(),n("div",K,[e("ul",Q,[(o(!0),n(g,null,h(i.value,a=>(o(),n("li",{key:a.id},[c(u,{to:`/issues/${a.id}`,class:"block hover:bg-gray-50"},{default:x(()=>{var m;return[e("div",U,[e("div",W,[e("p",X,l(a.title),1),e("div",Y,[e("p",{class:p(["px-2 inline-flex text-xs leading-5 font-semibold rounded-full",a.statusClass])},l(a.status),3)])]),e("div",Z,[e("div",ee,[e("p",se,l((m=a.event)==null?void 0:m.project.name),1)]),e("div",te,l(_(P)(a.created_at)),1)])])]}),_:2},1032,["to"])]))),128))])])):(o(),C(_(S),{key:1,title:"Задачи отсутствуют",icon:"heroicons:document-text",description:"Все выполнено! Либо пока что не время..."})),e("div",ae,[c(u,{to:"/issues",class:"cursor-pointer text-sm font-medium text-indigo-600 hover:text-indigo-500"},{default:x(()=>s[0]||(s[0]=[k(" Посмотреть все задачи ")])),_:1})])])}}}),ne={class:"bg-white shadow rounded-lg"},le={class:"bg-white overflow-hidden rounded-bl-lg rounded-br-lg"},re={class:"min-w-full divide-y divide-gray-200"},ie={class:"bg-white divide-y divide-gray-200"},ce={class:"px-6 py-4 whitespace-nowrap"},de={class:"flex items-center"},ue={class:"ml-4"},me={class:"text-sm font-medium text-gray-900"},_e={class:"text-sm text-gray-500"},ge={class:"px-6 py-4 whitespace-nowrap"},he={class:"text-sm text-gray-900"},pe={class:"text-sm text-gray-500"},xe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ve={class:"flex -space-x-2"},fe={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},ye=v({__name:"DashboardProjects",setup(f){const t=y([]),d=b(()=>t.value.length?t.value.map(r=>{var s;return{...r,icon:((s=M.find(u=>u.name===r.platform))==null?void 0:s.icon)||"",bgColor:B()}}):[]),i=async()=>{t.value=await $.get("/projects/dashboard")};return w(async()=>{await i()}),(r,s)=>{const u=L("RouterLink");return o(),n("div",ne,[s[2]||(s[2]=e("div",{class:"px-4 py-5 sm:px-6 border-b border-gray-200"},[e("h3",{class:"text-lg leading-6 font-medium text-gray-900"},"Ваши проекты")],-1)),e("div",le,[e("table",re,[s[1]||(s[1]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Проект "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Задачи (24ч) "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Команда "),e("th",{scope:"col",class:"relative px-6 py-3"},[e("span",{class:"sr-only"},"Редактировать")])])],-1)),e("tbody",ie,[(o(!0),n(g,null,h(d.value,a=>{var m;return o(),n("tr",{key:a.id,class:"hover:bg-gray-50"},[e("td",ce,[e("div",de,[e("div",{class:p(["flex-shrink-0 h-10 w-10 rounded-md flex items-center justify-center",a.bgColor])},[c(_(I),{icon:a.icon,class:"h-6 w-6 text-white"},null,8,["icon"])],2),e("div",ue,[e("div",me,l(a.name),1),e("div",_e,l(a.platform),1)])])]),e("td",ge,[e("div",he,l(a.issues),1),e("div",pe,l(a.resolved)+" решено ",1)]),e("td",xe,[e("div",ve,[(o(!0),n(g,null,h((m=a.team)==null?void 0:m.members,D=>(o(),C(_(N),{key:D.id,name:D.name},null,8,["name"]))),128))])]),e("td",fe,[c(u,{to:`/projects/${a.slug}/settings/general`,class:"text-indigo-600 hover:text-indigo-900"},{default:x(()=>s[0]||(s[0]=[k(" Настройки ")])),_:2},1032,["to"])])])}),128))])])])])}}}),Pe=v({__name:"Dashboard",setup(f){return(t,d)=>(o(),C(V,null,{default:x(()=>[c(H),c(oe),c(ye)]),_:1}))}});export{Pe as default};
