import"./index-Djch6Zjh.js";import{g as O,k as A,i as E,L as q}from"./install-CjK4hi0Q.js";import{d as z,i as B,k as D,q as P,a as p,o as c,v as G,c as m,j as L,w as h,b as e,e as a,m as w,u as o,t as x,g as M,l as S,F,n as J}from"./index-BJM9FpXo.js";import{_ as K}from"./EmptyState.vue_vue_type_script_setup_true_lang-BdG-MbLV.js";import{I as g}from"./client-D6K6htDN.js";import{S as y}from"./StatCard-B99VHW3b.js";import{_ as Q}from"./Badge.vue_vue_type_script_setup_true_lang-CWRgq3ED.js";import{_ as U}from"./Button.vue_vue_type_script_setup_true_lang-DLJ3rjid.js";import"./StacktraceViewer.vue_vue_type_style_index_0_scoped_7fdb99e3_lang-B8VJLqpg.js";import{_ as V}from"./ThePanel.vue_vue_type_script_setup_true_lang-549Hm_ud.js";import{a as W}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-CjAASZmf.js";import{u as X}from"./healthcheck-BJ3IMW9p.js";import{f as Y}from"./index-CaLwU_wJ.js";import{_ as Z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-B9uLu0-5.js";import"./users-BNnsnLpB.js";import"./projects-CJzepl33.js";import"./platforms-D8ztvdxx.js";const ee=z({__name:"ResponseTimeChart",props:{data:{type:Array,required:!0}},setup($){const _=$,l=B(null);D(()=>{r()}),P(()=>_.data,()=>{r()});function r(){if(!l.value)return;O(l.value)&&A(l.value);const u=E(l.value),b={tooltip:{trigger:"axis",formatter:d=>{const v=d[0];return`${v.axisValue}: ${v.value}ms`}},grid:{left:"4%",right:"5%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:_.data.map(d=>d.hour),axisLabel:{rotate:45}},yAxis:{type:"value",name:"Время ответа (ms)",axisLine:{show:!0}},series:[{name:"Время ответа",type:"line",smooth:!0,data:_.data.map(d=>d.avg_time),itemStyle:{color:"#4f46e5"},areaStyle:{color:new q(0,0,0,1,[{offset:0,color:"rgba(79, 70, 229, 0.3)"},{offset:1,color:"rgba(79, 70, 229, 0.1)"}])}}]};u.setOption(b),new ResizeObserver(()=>{u.resize()}).observe(l.value)}return(f,u)=>(c(),p("div",{ref_key:"chartRef",ref:l,class:"w-full h-full min-w-100 min-h-100"},null,512))}}),te={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},se={class:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4 mb-8"},ae={class:"flex items-center space-x-3"},oe={class:"p-2 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-lg"},ie={key:0,class:"mt-2 flex items-center space-x-2"},ne={class:"px-2 py-1 text-xs font-medium rounded bg-indigo-100 text-indigo-800"},re={class:"text-sm text-gray-600 truncate max-w-md"},ce={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},le={class:"divide-y divide-gray-100"},de={class:"flex items-center justify-between"},ue={class:"flex items-center space-x-4"},me={class:"flex-shrink-0"},pe={class:"text-sm font-medium text-gray-900"},ve={class:"text-sm text-gray-500"},_e={class:"flex items-center space-x-4"},fe=["onClick"],xe={key:0,class:"mt-3 p-3 bg-red-50 text-red-800 text-sm rounded-lg border border-red-100"},he={class:"mt-1 break-words"},ge=z({__name:"Results",setup($){const _=G(),l=Number(_.params.endpointId),r=X(),f=m(()=>[...r.results].splice(0,20)),u=m(()=>r.stats),b=m(()=>r.isLoading),i=m(()=>r.chartData),d=m(()=>f.value[0]),v=B(null),N=m(()=>{if(!i.value||i.value.length<2)return;const n=i.value[0].response_time,t=i.value[i.value.length-1].response_time;return t>n?"up":t<n?"down":void 0}),j=m(()=>{if(!i.value||i.value.length<2)return;const n=i.value[0].response_time;return`${((i.value[i.value.length-1].response_time-n)/n*100).toFixed(2)}%`}),H=n=>{if(!n.success){const t=n.error_message||`HTTP ${n.status_code}`;navigator.clipboard.writeText(t),v.value=n.id,setTimeout(()=>v.value=null,2e3)}};return D(async()=>{await r.fetchEndpointResults(l)}),(n,t)=>(c(),L(W,null,{default:h(()=>{var k,T,C,R,I;return[e("div",te,[e("div",se,[e("div",null,[e("div",ae,[e("div",oe,[a(o(g),{icon:"heroicons:heart",class:"h-6 w-6 text-white"})]),t[1]||(t[1]=e("h1",{class:"text-2xl font-bold text-gray-900"},"Health Check Мониторинг",-1))]),o(r).endpoint?(c(),p("div",ie,[e("span",ne,x(o(r).endpoint.method),1),e("p",re,x(o(r).endpoint.url),1)])):w("",!0)]),a(o(U),{onClick:t[0]||(t[0]=s=>n.$router.back()),variant:"outline",class:"self-start sm:self-center"},{default:h(()=>[a(o(g),{icon:"heroicons:arrow-left",class:"mr-2 h-4 w-4"}),t[2]||(t[2]=M(" Назад "))]),_:1,__:[2]})]),e("div",ce,[a(y,{title:"Ср. время ответа",value:`${((k=u.value)==null?void 0:k.avg_response_time.toFixed(2))??0}ms`,icon:"heroicons:clock",trend:N.value,"trend-value":j.value},null,8,["value","trend","trend-value"]),a(y,{title:"Аптайм",value:`${((T=u.value)==null?void 0:T.uptime_percentage.toFixed(2))??100}%`,icon:"heroicons:shield-check",variant:"success"},null,8,["value"]),a(y,{title:"Всего проверок",value:((C=u.value)==null?void 0:C.total_checks)??0,icon:"heroicons:check-badge",variant:"primary"},null,8,["value"]),a(y,{title:"Последний статус",value:((R=d.value)==null?void 0:R.status_code)??"-",variant:(I=d.value)!=null&&I.success?"success":"danger",icon:"heroicons:exclamation-circle"},null,8,["value","variant"])]),a(o(V),{title:"Время ответа (последние 24 часа)"},{default:h(()=>[a(ee,{data:i.value},null,8,["data"])]),_:1}),a(o(V),{title:"История проверок"},{default:h(()=>[e("div",le,[b.value?(c(),p(F,{key:0},S(5,s=>e("div",{key:s,class:"p-6"},t[3]||(t[3]=[e("div",{class:"animate-pulse flex space-x-4"},[e("div",{class:"flex-1 space-y-4 py-1"},[e("div",{class:"h-4 bg-gray-100 rounded w-3/4"}),e("div",{class:"space-y-2"},[e("div",{class:"h-4 bg-gray-100 rounded"})])])],-1)]))),64)):f.value.length===0?(c(),L(o(K),{key:1,title:"Нет данных",icon:"heroicons:inbox",description:"Здесь будут отображаться результаты проверок",class:"p-8"})):(c(!0),p(F,{key:2},S(f.value,s=>(c(),p("div",{key:s.id,class:"p-5 hover:bg-gray-50 transition-colors duration-150"},[e("div",de,[e("div",ue,[e("div",me,[e("div",{class:J(["h-10 w-10 rounded-full flex items-center justify-center",s.success?"bg-green-100 text-green-600":"bg-red-100 text-red-600"])},[a(o(g),{icon:s.success?"heroicons:check":"heroicons:x-mark",class:"h-5 w-5"},null,8,["icon"])],2)]),e("div",null,[e("p",pe,x(o(Y)(s.created_at)),1),e("p",ve,x(s.response_time.toFixed(2))+" ms ",1)])]),e("div",_e,[a(o(Q),{variant:s.success?"success":"danger",text:`HTTP ${s.status_code}`},null,8,["variant","text"]),s.success?w("",!0):(c(),p("button",{key:0,onClick:ye=>H(s),class:"text-gray-400 hover:text-gray-600",title:"Копировать ошибку"},[a(o(g),{icon:"heroicons:clipboard",class:"h-5 w-5"})],8,fe))])]),!s.success&&v.value===s.id?(c(),p("div",xe,[t[4]||(t[4]=e("p",{class:"font-medium"},"Ошибка:",-1)),e("p",he,x(s.error_message||"Нет описания ошибки"),1)])):w("",!0)]))),128))])]),_:1})])]}),_:1}))}}),Oe=Z(ge,[["__scopeId","data-v-227d653a"]]);export{Oe as default};
