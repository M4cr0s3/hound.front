import{h as _}from"./client-D6K6htDN.js";import"./StacktraceViewer.vue_vue_type_style_index_0_scoped_7fdb99e3_lang-B8VJLqpg.js";import{_ as c}from"./InputField.vue_vue_type_script_setup_true_lang-BrMCFGzf.js";import{A as x,_ as w}from"./AuthLayout-BYAEeMcE.js";import{_ as h}from"./SubmitButton.vue_vue_type_script_setup_true_lang-BW5DWCjO.js";import{d as p,a as g,o as f,b as r,h as v,r as b,i as m,f as y,R as S,K as V,j as $,w as d,e as n,u as o,g as E}from"./index-BJM9FpXo.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const k=async i=>_.post("/auth/login",i),A={class:"mt-8 sm:mx-auto sm:w-full sm:max-w-md"},B={class:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10"},L=p({__name:"AuthForm",emits:["submit"],setup(i){return(s,a)=>(f(),g("div",A,[r("div",B,[r("form",{class:"space-y-6",onSubmit:a[0]||(a[0]=v(l=>s.$emit("submit"),["prevent"]))},[b(s.$slots,"default")],32)])]))}}),R=()=>{const i=y(),s=m({email:"",password:""}),a=m({fieldErrors:{},commonError:""}),l=m(!1),u=()=>{a.value={fieldErrors:{},commonError:""}};return{credentials:s,errors:a,isLoading:l,handleSubmit:async()=>{u(),l.value=!0;try{const e=await k(s.value);if(!(e!=null&&e.token))return;localStorage.setItem("token",e.token),await i.push(S.DASHBOARD)}catch(e){(e.status===422||e.status===403)&&(V.error("Неправильный логин или пароль",{duration:3e3,description:e.message}),a.value.commonError=e.message)}finally{l.value=!1}}}},C={class:"sm:mx-auto flex items-center flex-col sm:w-full sm:max-w-md"},N={class:"mt-8 sm:mx-auto sm:w-full sm:max-w-md"},F=p({__name:"Login",setup(i){const{credentials:s,isLoading:a,handleSubmit:l}=R();return(u,t)=>(f(),$(x,null,{default:d(()=>[r("div",C,[n(o(w),{width:128,height:128}),t[2]||(t[2]=r("h2",{class:"text-center text-3xl font-extrabold text-gray-900"}," Войдите в свой аккаунт ",-1))]),r("div",N,[n(L,{onSubmit:o(l)},{default:d(()=>[n(o(c),{id:"email",modelValue:o(s).email,"onUpdate:modelValue":t[0]||(t[0]=e=>o(s).email=e),label:"Электронная почта",type:"email",icon:"heroicons:envelope",placeholder:"dev@dev.ru",autocomplete:"email",required:""},null,8,["modelValue"]),n(o(c),{id:"password",modelValue:o(s).password,"onUpdate:modelValue":t[1]||(t[1]=e=>o(s).password=e),label:"Пароль",type:"password",icon:"heroicons:lock-closed",placeholder:"••••••••",autocomplete:"current-password",required:""},null,8,["modelValue"]),t[4]||(t[4]=r("div",{class:"flex items-center justify-between"},[r("div",{class:"text-sm"},[r("a",{href:"#",class:"font-medium text-indigo-600 hover:text-indigo-500"}," Забыли пароль? ")])],-1)),n(o(h),{loading:o(a)},{default:d(()=>t[3]||(t[3]=[E(" Войти")])),_:1,__:[3]},8,["loading"])]),_:1,__:[4]},8,["onSubmit"])])]),_:1}))}});export{F as default};
