import{d as P,a as j,o as d,b as s,p as R,e as n,f as e,s as I,w as a,h as u,t as v,k as y,m as X,C as Y,x as H,c as Z,l as f,i as J,y as ee,q as S,n as U,F as z,D as te,j as se}from"./index-BCF3V4H9.js";import{u as oe}from"./healthcheck-D2Nxa0nD.js";import{I as m}from"./iconify-B7i5wVmN.js";import{f as ne,a as ie}from"./index-BPW3n-1W.js";import{_ as le}from"./IssueItem.vue_vue_type_script_setup_true_lang-CVUhObkU.js";import{u as ae,i as re,a as de,b as ce,c as ue,d as pe,e as me,f as ve,h as fe,j as ge}from"./install-CjK4hi0Q.js";import{_ as E}from"./EmptyState.vue_vue_type_script_setup_true_lang-rc0N5t01.js";import{S as B}from"./StatCard-XA5vLsE5.js";import{_ as K}from"./Badge.vue_vue_type_script_setup_true_lang-CYxPQULT.js";import{_ as $}from"./Button.vue_vue_type_script_setup_true_lang-DUH1P037.js";import"./StacktraceViewer.vue_vue_type_style_index_0_scoped_8568d111_lang-OogGfIpQ.js";import{_ as q}from"./InputField.vue_vue_type_script_setup_true_lang-QcQn2eeV.js";import{u as xe,b as he,a as ye,M as A}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-C3vzuPhL.js";import{_ as Q}from"./SelectField.vue_vue_type_script_setup_true_lang-jqoG0XWG.js";import{_ as V}from"./ThePanel.vue_vue_type_script_setup_true_lang-Dia4GMkS.js";import{u as _e}from"./projects-DGv742xl.js";import"./platforms-D8ztvdxx.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-waWTbR4Y.js";const be={class:"px-5 py-4 hover:bg-gray-50 transition-colors duration-150"},we={class:"flex items-center justify-between"},ke={class:"flex items-center space-x-3 min-w-0"},$e={class:"min-w-0"},je={class:"mt-1 flex items-center space-x-3"},Ce={class:"text-xs text-gray-500"},Se={class:"text-xs text-gray-500"},Ee={class:"flex items-center space-x-4"},Ve=P({__name:"EndpointItem",props:{endpoint:{},slug:{}},setup(L){const l=oe();return(o,c)=>{const C=I("RouterLink");return d(),j("div",be,[s("div",we,[s("div",ke,[s("div",{class:R(["flex-shrink-0",{"text-green-500":o.endpoint.is_active,"text-red-500":!o.endpoint.is_active}])},[n(e(m),{icon:o.endpoint.is_active?"heroicons:check-circle":"heroicons:x-circle",class:"h-5 w-5"},null,8,["icon"])],2),s("div",$e,[n(C,{to:`/healthcheck/${o.endpoint.id}/results`,class:"text-sm font-medium text-gray-900 truncate"},{default:a(()=>[u(v(o.endpoint.url),1)]),_:1},8,["to"]),s("div",je,[s("span",Ce," HTTP "+v(o.endpoint.expected_status),1),s("span",Se," Каждые "+v(o.endpoint.interval)+" мин ",1)])])]),s("div",Ee,[s("button",{onClick:c[0]||(c[0]=g=>e(l).deleteEndpoint(o.endpoint.id,o.slug)),class:"text-gray-400 hover:text-red-500"},[n(e(m),{icon:"heroicons:trash",class:"h-4 w-4 cursor-pointer"})])])])])}}}),Le={class:"px-5 py-4 hover:bg-gray-50 transition-colors duration-150"},Fe={class:"flex items-start space-x-3"},Te={class:"min-w-0 flex-1"},Be={class:"text-sm font-medium text-gray-900 truncate"},Re={class:"mt-1 flex flex-wrap items-center gap-x-3 gap-y-1"},Pe={class:"text-xs text-gray-500"},Me=P({__name:"EventItem",props:{event:{},projectSlug:{}},setup(L){return(l,o)=>{const c=I("RouterLink");return d(),j("div",Le,[s("div",Fe,[s("div",{class:R(["flex-shrink-0 mt-1",{"text-red-500":l.event.level==="error"||l.event.level==="critical","text-amber-500":l.event.level==="warning","text-gray-500":l.event.level==="info"}])},[n(e(m),{icon:{critical:"heroicons:exclamation-triangle",error:"heroicons:exclamation-circle",warning:"heroicons:exclamation-circle",info:"heroicons:information-circle"}[l.event.level],class:"h-5 w-5"},null,8,["icon"])],2),s("div",Te,[s("p",Be,v(l.event.message),1),s("div",Re,[s("span",Pe,v(e(ne)(l.event.created_at)),1),s("span",{class:R(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",{"bg-red-100 text-red-800":l.event.level==="error"||l.event.level==="critical","bg-amber-100 text-amber-800":l.event.level==="warning","bg-blue-100 text-blue-800":l.event.level==="info"}])},v(l.event.level),3)])]),n(c,{to:`/events/${l.event.id}`,class:"text-gray-400 hover:text-gray-500"},{default:a(()=>[n(e(m),{icon:"heroicons:chevron-right",class:"h-5 w-5"})]),_:1},8,["to"])])])}}}),Ue=P({__name:"LineChart",props:{data:{type:Array,required:!0},title:{type:String,default:""}},setup(L){ae([de,ce,ue,pe,me,ve,fe,ge]);const l=L,o=y(null);let c=null;const C=()=>{o.value&&(c=re(o.value),g())},g=()=>{if(!c)return;const _=Math.max(...l.data.map(r=>r.total)),h=Math.ceil(_*1.2),k=l.data.map(r=>r.date),p=l.data.map(r=>r.errors),F=l.data.map(r=>r.warnings),M={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:r=>{const b=r[0].data;return`
          <div class="text-gray-900 font-medium">${r[0].axisValue}</div>
          <div class="mt-2 space-y-1">
            <div class="flex items-center">
              <span class="inline-block w-3 h-3 rounded-full mr-2 bg-[#6366F1]"></span>
              <span>Всего: <strong>${b.total}</strong></span>
            </div>
            <div class="flex items-center">
              <span class="inline-block w-3 h-3 rounded-full mr-2 bg-[#EF4444]"></span>
              <span>Ошибки: <strong>${b.errors}</strong></span>
            </div>
            <div class="flex items-center">
              <span class="inline-block w-3 h-3 rounded-full mr-2 bg-[#F59E0B]"></span>
              <span>Предупреждения: <strong>${b.warnings}</strong></span>
            </div>
          </div>
        `}},legend:{data:["Всего","Ошибки","Предупреждения"],bottom:0},grid:{left:"3%",right:"4%",bottom:"15%",top:l.title?"10%":"5%",containLabel:!0},xAxis:{type:"category",data:k,axisLine:{lineStyle:{color:"#E5E7EB"}},axisLabel:{color:"#6B7280"}},yAxis:{max:h,type:"value",axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"#F3F4F6"}},axisLabel:{color:"#6B7280"}},series:[{name:"Всего",type:"bar",barWidth:"60%",itemStyle:{color:"#6366F1",borderRadius:[12,12,0,0]},data:l.data.map(r=>({value:r.total,total:r.total,errors:r.errors,warnings:r.warnings}))},{name:"Ошибки",type:"line",smooth:!0,symbolSize:8,lineStyle:{width:3,color:"#EF4444"},itemStyle:{color:"#EF4444",borderWidth:2,borderColor:"#fff"},data:p},{name:"Предупреждения",type:"line",smooth:!0,symbolSize:8,lineStyle:{width:3,color:"#F59E0B"},itemStyle:{color:"#F59E0B",borderWidth:2,borderColor:"#fff"},data:F}],...l.title&&{title:{text:l.title,left:"center",textStyle:{color:"#111827",fontWeight:"normal",fontSize:14}}}};c.setOption(M)},w=()=>{c==null||c.resize()};return X(()=>{C(),window.addEventListener("resize",w)}),Y(()=>{window.removeEventListener("resize",w),c==null||c.dispose()}),H(()=>l.data,()=>{g()},{deep:!0}),H(()=>l.color,()=>{g()}),(_,h)=>(d(),j("div",{ref_key:"chartRef",ref:o,class:"w-full h-[300px]"},null,512))}}),ze={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8"},qe={class:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4"},Ae={class:"flex items-start space-x-4"},He={class:"p-3 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-xl shadow-md"},Ie={class:"text-2xl font-bold text-gray-900"},Ne={class:"flex flex-wrap items-center gap-2 mt-2"},De={class:"flex space-x-3"},Oe={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},We={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Ge={class:"lg:col-span-2 space-y-6"},Je={class:"divide-y divide-gray-100"},Ke={class:"space-y-6"},Qe={class:"divide-y divide-gray-100"},Xe={class:"divide-y divide-gray-100"},Ye={class:"divide-y divide-gray-100"},Ze={class:"flex items-center space-x-4"},et={class:"flex-1 min-w-0"},tt={class:"flex items-center justify-between"},st={class:"text-sm font-medium text-indigo-600 truncate"},ot={class:"flex justify-center gap-10 pt-5"},nt={class:"text-center"},it={class:"mt-2 text-sm text-gray-500"},lt={class:"flex justify-end gap-3"},at={class:"flex justify-end gap-3"},St=P({__name:"Show",setup(L){const l=ee(),o=_e(),{getColor:c}=xe(),C=x=>x.charAt(0).toUpperCase(),g=y({events_today:0,events_week:0,active_issues:0,uptime_percentage:100}),w=y([]),_=y(!1),h=y(!1),k=y(!1),p=y({url:"",expected_status:200,interval:5,method:"GET",is_active:!0}),F=y({name:"",slug:"",team_id:0,platform:""}),M=he(),r=Z(()=>o.project.endpoints.length?g.value.uptime_percentage/o.project.endpoints.length:0),b=async()=>{try{const x=await J.get(`/projects/${l.params.slug}`);o.project=x.project,g.value=x.stats,w.value=x.daily_stats}catch(x){console.error("Error fetching project:",x)}},N=async()=>{try{await J.post(`/healthcheck/${o.project.slug}`,p.value),await b(),h.value=!1,p.value={url:"",expected_status:200,interval:5,method:"GET",is_active:!0}}catch(x){console.error("Error adding endpoint:",x)}};return H(()=>l.params.slug,()=>b()),X(()=>{b()}),(x,t)=>{const T=I("RouterLink");return d(),f(ye,null,{default:a(()=>[s("div",ze,[s("div",qe,[s("div",Ae,[s("div",He,[n(e(m),{icon:e(ie)(e(o).project.platform),class:"h-8 w-8 text-white"},null,8,["icon"])]),s("div",null,[s("h1",Ie,v(e(o).project.name),1),s("div",Ne,[n(e(K),{variant:"primary",class:"flex items-center"},{default:a(()=>{var i;return[n(e(m),{icon:"heroicons:user-group",class:"mr-1 h-4 w-4"}),u(" "+v((i=e(o).project.team)==null?void 0:i.name),1)]}),_:1}),n(e(K),{variant:"secondary",class:"flex items-center"},{default:a(()=>[n(e(m),{icon:"heroicons:computer-desktop",class:"mr-1 h-4 w-4"}),u(" "+v(e(o).project.platform),1)]),_:1})])])]),s("div",De,[n(T,{to:`/projects/${e(o).project.slug}/settings/general`,class:"inline-flex items-center px-4 py-2 bg-white border border-gray-200 text-gray-700 text-sm font-medium rounded-lg shadow-sm hover:bg-gray-50 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"},{default:a(()=>[n(e(m),{icon:"heroicons:cog-6-tooth",class:"mr-2 h-4 w-4"}),t[16]||(t[16]=u(" Настройки "))]),_:1},8,["to"]),s("button",{onClick:t[0]||(t[0]=i=>_.value=!0),class:"inline-flex items-center px-4 py-2 cursor-pointer bg-white border border-gray-200 text-red-600 text-sm font-medium rounded-lg shadow-sm hover:bg-red-50 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2"},[n(e(m),{icon:"heroicons:trash",class:"mr-2 h-4 w-4"}),t[17]||(t[17]=u(" Удалить "))])])]),s("div",Oe,[n(B,{title:"Событий сегодня",value:g.value.events_today,icon:"heroicons:bell-alert"},null,8,["value"]),n(B,{title:"Событий за неделю",value:g.value.events_week,icon:"heroicons:calendar-days"},null,8,["value"]),n(B,{title:"Активных задач",value:g.value.active_issues,icon:"heroicons:exclamation-triangle",variant:"warning"},null,8,["value"]),n(B,{title:"Аптайм",value:`${r.value}%`,icon:"heroicons:shield-check",variant:"success"},null,8,["value"])]),s("div",We,[s("div",Ge,[n(e(V),{title:"Активность (7 дней)"},{default:a(()=>[w.value.length?(d(),f(Ue,{key:0,data:w.value,title:"Активность событий",color:"#8B5CF6","show-mark-line":!0},null,8,["data"])):(d(),f(e(E),{key:1,title:"Нет активностей",icon:"heroicons:users",description:"Добавьте endpoints и здесь будет график.",class:"p-6",small:""}))]),_:1}),n(e(V),{title:"Последние события"},{button:a(()=>[n(T,{to:`/projects/${e(o).project.slug}/events`,class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"},{default:a(()=>t[18]||(t[18]=[u(" Показать все ")])),_:1},8,["to"])]),default:a(()=>[s("div",Je,[(d(!0),j(z,null,U(e(o).project.events,i=>(d(),f(Me,{key:i.id,event:i,class:"hover:bg-gray-50 transition-colors duration-150","project-slug":e(o).project.slug},null,8,["event","project-slug"]))),128)),e(o).project.events.length?S("",!0):(d(),f(e(E),{key:0,title:"Событий не найдено",icon:"heroicons:bell",description:"Здесь будут отображаться последние события вашего проекта.",class:"p-6",small:""}))])]),_:1})]),s("div",Ke,[n(e(V),{title:"Health Check Endpoints"},{button:a(()=>[s("button",{onClick:t[1]||(t[1]=i=>h.value=!0),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium cursor-pointer"},[n(e(m),{icon:"heroicons:plus",class:"h-4 w-4"})])]),default:a(()=>[s("div",Qe,[(d(!0),j(z,null,U(e(o).project.endpoints,i=>(d(),f(Ve,{slug:e(o).project.slug,key:i.id,endpoint:i,class:"hover:bg-gray-50 transition-colors duration-150"},null,8,["slug","endpoint"]))),128)),e(o).project.endpoints.length?S("",!0):(d(),f(e(E),{key:0,title:"Нет endpoints",icon:"heroicons:link",description:"Добавьте health check endpoints для мониторинга.",class:"p-6",small:""}))])]),_:1}),n(e(V),{title:"Последние проблемы"},{button:a(()=>[n(T,{to:`/projects/${e(o).project.slug}/issues`,class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"},{default:a(()=>t[19]||(t[19]=[u(" Показать все ")])),_:1},8,["to"])]),default:a(()=>[s("div",Xe,[(d(!0),j(z,null,U(e(o).project.issues,i=>(d(),f(le,{key:i.id,issue:i,class:"hover:bg-gray-50 transition-colors duration-150","project-slug":e(o).project.slug},null,8,["issue","project-slug"]))),128)),e(o).project.issues.length?S("",!0):(d(),f(e(E),{key:0,title:"Проблем не найдено",icon:"heroicons:check-badge",description:"Отличная работа! Активных проблем нет.",class:"p-6",small:""}))])]),_:1}),n(e(V),{title:"Команда"},te({default:a(()=>{var i,D;return[s("div",Ye,[(i=e(o).project.team)!=null&&i.name?(d(),f(T,{key:0,to:`/teams/${(D=e(o).project.team)==null?void 0:D.slug}`,class:"block hover:bg-gray-50 px-4 py-4 sm:px-6"},{default:a(()=>{var O,W,G;return[s("div",Ze,[s("div",{class:R(["flex-shrink-0 h-10 w-10 rounded-md flex items-center justify-center text-white font-medium",e(c)((O=e(o).project.team)==null?void 0:O.name)])},v(C((W=e(o).project.team)==null?void 0:W.name)),3),s("div",et,[s("div",tt,[s("p",st,v((G=e(o).project.team)==null?void 0:G.name),1)])])])]}),_:1},8,["to"])):S("",!0),e(o).project.team?S("",!0):(d(),f(e(E),{key:1,title:"Нет команды",icon:"heroicons:users",description:"Добавьте команду",class:"p-6",small:""}))])]}),_:2},[e(o).project.team?void 0:{name:"button",fn:a(()=>[s("button",{onClick:t[2]||(t[2]=i=>k.value=!0),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium cursor-pointer"},[n(e(m),{icon:"heroicons:plus",class:"h-4 w-4"})])]),key:"0"}]),1024)])])]),n(e(A),{"is-open":k.value,onClose:t[6]||(t[6]=i=>k.value=!1),title:"Выбор команды"},{content:a(()=>[t[22]||(t[22]=s("div",{class:"text-center"},[s("h3",{class:"mt-2 text-lg font-medium text-gray-900"},"Выберите команду")],-1)),n(e(Q),{modelValue:F.value.team_id,"onUpdate:modelValue":t[3]||(t[3]=i=>F.value.team_id=i),options:e(M).teams,label:"Команда",placeholder:"Выберите команду","option-label":"name","option-value":"id","no-options-value":"Команды отсутствуют",required:""},null,8,["modelValue","options"]),s("div",ot,[n(e($),{variant:"secondary",onClick:t[4]||(t[4]=i=>k.value=!1)},{default:a(()=>t[20]||(t[20]=[u(" Отмена ")])),_:1}),n(e($),{variant:"danger",onClick:t[5]||(t[5]=()=>{})},{default:a(()=>t[21]||(t[21]=[u(" Добавить ")])),_:1})])]),_:1},8,["is-open"]),n(e(A),{"is-open":_.value,onClose:t[9]||(t[9]=i=>_.value=!1),title:"Подтверждение удаления"},{content:a(()=>[s("div",nt,[n(e(m),{icon:"heroicons:exclamation-triangle",class:"mx-auto h-12 w-12 text-red-500"}),t[24]||(t[24]=s("h3",{class:"mt-2 text-lg font-medium text-gray-900"},"Удалить проект?",-1)),s("div",it,[s("p",null,'Вы уверены, что хотите удалить проект "'+v(e(o).project.name)+'"?',1),t[23]||(t[23]=s("p",{class:"mt-1"},"Это действие нельзя отменить.",-1))])])]),footer:a(()=>[s("div",lt,[n(e($),{variant:"secondary",onClick:t[7]||(t[7]=i=>_.value=!1)},{default:a(()=>t[25]||(t[25]=[u(" Отмена ")])),_:1}),n(e($),{variant:"danger",onClick:t[8]||(t[8]=i=>e(o).destroy(e(o).project.slug))},{default:a(()=>t[26]||(t[26]=[u(" Удалить ")])),_:1})])]),_:1},8,["is-open"]),n(e(A),{"is-open":h.value,onClose:t[15]||(t[15]=i=>h.value=!1),title:"Добавить Health Check Endpoint"},{content:a(()=>[s("form",{onSubmit:se(N,["prevent"]),class:"space-y-4"},[n(e(q),{id:"endpoint-url",modelValue:p.value.url,"onUpdate:modelValue":t[10]||(t[10]=i=>p.value.url=i),label:"URL Endpoint",placeholder:"https://example.com/health",required:"",icon:"heroicons:link"},null,8,["modelValue"]),n(e(q),{id:"exp-status",modelValue:p.value.expected_status,"onUpdate:modelValue":t[11]||(t[11]=i=>p.value.expected_status=i),label:"Ожидаемый HTTP статус",type:"number",placeholder:"200",required:"",icon:"heroicons:hashtag",minValue:1,maxValue:550},null,8,["modelValue"]),n(e(q),{modelValue:p.value.interval,"onUpdate:modelValue":t[12]||(t[12]=i=>p.value.interval=i),label:"Интервал проверки (минуты)",type:"number",placeholder:"5",required:"",icon:"heroicons:clock",id:"check-interval",minValue:1,maxValue:60},null,8,["modelValue"]),n(e(Q),{options:["GET","POST","PUT","PATCH","OPTIONS"],modelValue:p.value.method,"onUpdate:modelValue":t[13]||(t[13]=i=>p.value.method=i),label:"Метод",required:""},null,8,["modelValue"])],32)]),footer:a(()=>[s("div",at,[n(e($),{variant:"secondary",onClick:t[14]||(t[14]=i=>h.value=!1)},{default:a(()=>t[27]||(t[27]=[u(" Отмена ")])),_:1}),n(e($),{onClick:N},{default:a(()=>t[28]||(t[28]=[u(" Добавить ")])),_:1})])]),_:1},8,["is-open"])]),_:1})}}});export{St as default};
