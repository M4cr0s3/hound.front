import{i as _,d as p,a as x,o as f,b as r,j as w,r as g,k as m,g as h,R as v,K as b,l as y,w as d,e as n,f as o,h as S}from"./index-uO5KFaZX.js";import"./iconify-DXTi0Chq.js";import"./CommentForm.vue_vue_type_style_index_0_scoped_8b816cc4_lang-BVKzazvO.js";import{_ as c}from"./InputField.vue_vue_type_script_setup_true_lang-DAxvVOzP.js";import{_ as V}from"./SubmitButton.vue_vue_type_script_setup_true_lang-Blj6mZx9.js";import{A as $,_ as k}from"./AuthLayout-DliaWl_b.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const E=async i=>_.post("/auth/login",i),A={class:"mt-8 sm:mx-auto sm:w-full sm:max-w-md"},B={class:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10"},L=p({__name:"AuthForm",emits:["submit"],setup(i){return(s,a)=>(f(),x("div",A,[r("div",B,[r("form",{class:"space-y-6",onSubmit:a[0]||(a[0]=w(l=>s.$emit("submit"),["prevent"]))},[g(s.$slots,"default")],32)])]))}}),R=()=>{const i=h(),s=m({email:"",password:""}),a=m({fieldErrors:{},commonError:""}),l=m(!1),u=()=>{a.value={fieldErrors:{},commonError:""}};return{credentials:s,errors:a,isLoading:l,handleSubmit:async()=>{u(),l.value=!0;try{const e=await E(s.value);if(!(e!=null&&e.token))return;localStorage.setItem("token",e.token),await i.push(v.DASHBOARD)}catch(e){(e.status===422||e.status===403)&&(b.error("Неправильный логин или пароль",{duration:3e3,description:e.message}),a.value.commonError=e.message)}finally{l.value=!1}}}},C={class:"sm:mx-auto flex items-center flex-col sm:w-full sm:max-w-md"},N={class:"mt-8 sm:mx-auto sm:w-full sm:max-w-md"},F=p({__name:"Login",setup(i){const{credentials:s,isLoading:a,handleSubmit:l}=R();return(u,t)=>(f(),y($,null,{default:d(()=>[r("div",C,[n(o(k),{width:128,height:128}),t[2]||(t[2]=r("h2",{class:"text-center text-3xl font-extrabold text-gray-900"}," Войдите в свой аккаунт ",-1))]),r("div",N,[n(L,{onSubmit:o(l)},{default:d(()=>[n(o(c),{id:"email",modelValue:o(s).email,"onUpdate:modelValue":t[0]||(t[0]=e=>o(s).email=e),label:"Электронная почта",type:"email",icon:"heroicons:envelope",placeholder:"dev@dev.ru",autocomplete:"email",required:""},null,8,["modelValue"]),n(o(c),{id:"password",modelValue:o(s).password,"onUpdate:modelValue":t[1]||(t[1]=e=>o(s).password=e),label:"Пароль",type:"password",icon:"heroicons:lock-closed",placeholder:"••••••••",autocomplete:"current-password",required:""},null,8,["modelValue"]),t[4]||(t[4]=r("div",{class:"flex items-center justify-between"},[r("div",{class:"text-sm"},[r("a",{href:"#",class:"font-medium text-indigo-600 hover:text-indigo-500"}," Забыли пароль? ")])],-1)),n(o(V),{loading:o(a)},{default:d(()=>t[3]||(t[3]=[S(" Войти")])),_:1,__:[3]},8,["loading"])]),_:1,__:[4]},8,["onSubmit"])])]),_:1}))}});export{F as default};
