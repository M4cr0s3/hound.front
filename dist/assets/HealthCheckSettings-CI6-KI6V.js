import{d as k,x as w,k as E,m as V,a,b as e,j as C,e as n,f as i,F as p,n as g,o as r,t as u,w as S,h as T,s as A,p as U}from"./index-CP1nmCJy.js";import{I as x}from"./iconify-C5CIr0u4.js";import{u as $}from"./healthcheck-Byseow-Y.js";import{_ as c}from"./InputField.vue_vue_type_script_setup_true_lang-Bq-tynp1.js";import{_ as D}from"./SelectField.vue_vue_type_script_setup_true_lang-CPRWSgYS.js";import{_ as H}from"./Checkbox.vue_vue_type_script_setup_true_lang-i4mS5gWi.js";import"./index-C2jT-Dqp.js";const L={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},j={class:"bg-white shadow-sm rounded-lg mb-8"},N={class:"px-4 py-5 sm:p-6"},P={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},q={class:"mt-6"},B=["disabled"],G={key:0},I={key:1},M={class:"bg-white rounded-lg border border-gray-200 mt-4"},O={class:"px-4 py-5 sm:p-6"},R={key:0,class:"space-y-4"},F={key:1,class:"text-center py-8"},z={key:2,class:"space-y-4"},J={class:"flex justify-between items-start"},K={class:"flex items-center space-x-2"},Q={class:"font-medium"},W={class:"mt-2 text-sm text-gray-500"},X={class:"flex space-x-2"},Y=["onClick","title"],Z=["onClick"],de=k({__name:"HealthCheckSettings",setup(ee){const m=w().params.slug,l=$(),_=["GET","POST","PUT","PATCH","DELETE","HEAD","OPTIONS"],o=E({url:"",method:"GET",expected_status:200,interval:5,is_active:!0}),h=async()=>{try{await l.addEndpoint(m,o.value),o.value={url:"",method:"GET",expected_status:200,interval:5,is_active:!0}}catch(d){console.error("Error adding endpoint:",d)}},v=async d=>{try{await l.toggleEndpointStatus(d.id)}catch(t){console.error("Error toggling endpoint status:",t)}},y=async d=>{if(confirm("Are you sure you want to delete this endpoint?"))try{await l.deleteEndpoint(d.id)}catch(t){console.error("Error deleting endpoint:",t)}};return V(async()=>{await l.fetchEndpoints(m)}),(d,t)=>{const f=A("RouterLink");return r(),a("div",L,[t[10]||(t[10]=e("div",{class:"flex justify-between items-center mb-6"},[e("h1",{class:"text-2xl font-bold text-gray-900"},"Настройки Healthcheck")],-1)),e("div",j,[e("div",N,[t[5]||(t[5]=e("h2",{class:"text-lg font-medium text-gray-900 mb-4"}," Добавить новый эндпоинт для проверки состояния ",-1)),e("form",{onSubmit:C(h,["prevent"])},[e("div",P,[n(c,{id:"url",modelValue:o.value.url,"onUpdate:modelValue":t[0]||(t[0]=s=>o.value.url=s),label:"Ссылка",type:"text",placeholder:"https://example.com",required:""},null,8,["modelValue"]),n(D,{modelValue:o.value.method,"onUpdate:modelValue":t[1]||(t[1]=s=>o.value.method=s),options:_,label:"Метод",placeholder:"Выберите метод"},null,8,["modelValue"]),n(c,{id:"expected_status",modelValue:o.value.expected_status,"onUpdate:modelValue":t[2]||(t[2]=s=>o.value.expected_status=s),label:"Ожидаемый статус код",type:"number",placeholder:"200",required:""},null,8,["modelValue"]),n(c,{id:"interval",modelValue:o.value.interval,"onUpdate:modelValue":t[3]||(t[3]=s=>o.value.interval=s),label:"Интервал между проверками (в минутах)",type:"number",placeholder:"1",required:""},null,8,["modelValue"]),n(H,{id:"is_active",modelValue:o.value.is_active,"onUpdate:modelValue":t[4]||(t[4]=s=>o.value.is_active=s),label:"Активность мониторинга"},null,8,["modelValue"])]),e("div",q,[e("button",{type:"submit",class:"w-full cursor-pointer items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",disabled:i(l).isAdding},[i(l).isAdding?(r(),a("span",G,"Добавляем...")):(r(),a("span",I,"Добавить"))],8,B)])],32)])]),e("div",M,[t[9]||(t[9]=e("div",{class:"px-6 py-4 border-b border-gray-200 flex items-center justify-between"},[e("h2",{class:"text-lg font-medium text-gray-900"}," Текущий список эндпоинтов ")],-1)),e("div",O,[i(l).isLoading?(r(),a("div",R,[(r(),a(p,null,g(3,s=>e("div",{key:s,class:"animate-pulse"},t[6]||(t[6]=[e("div",{class:"h-16 bg-gray-100 rounded-md"},null,-1)]))),64))])):i(l).endpoints.length===0?(r(),a("div",F,t[7]||(t[7]=[e("p",{class:"text-gray-500"},"Пока что ничего нет.",-1)]))):(r(),a("ul",z,[(r(!0),a(p,null,g(i(l).endpoints,s=>(r(),a("li",{key:s.id,class:"border border-gray-200 rounded-md p-4"},[e("div",J,[e("div",null,[e("div",K,[e("span",Q,u(s.method),1),n(f,{to:`/healthcheck/${s.id}/results`,class:"text-gray-600"},{default:S(()=>[T(u(s.url),1)]),_:2},1032,["to"]),e("span",{class:U(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",s.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"])},u(s.is_active?"Активен":"Неактивен"),3)]),e("div",W,[e("span",null,"Ожидаемый статус: "+u(s.expected_status),1),t[8]||(t[8]=e("span",{class:"mx-2"},"•",-1)),e("span",null,"Интервал: каждые "+u(s.interval)+" мин.",1)])]),e("div",X,[e("button",{onClick:b=>v(s),class:"text-gray-400 hover:text-gray-500",title:s.is_active?"Disable":"Enable"},[n(i(x),{icon:s.is_active?"heroicons:eye":"heroicons:eye-slash",class:"h-5 w-5 cursor-pointer"},null,8,["icon"])],8,Y),e("button",{onClick:b=>y(s),class:"text-gray-400 hover:text-red-500",title:"Delete"},[n(i(x),{icon:"heroicons:trash",class:"h-5 w-5 cursor-pointer"})],8,Z)])])]))),128))]))])])])}}});export{de as default};
