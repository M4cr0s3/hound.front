import{d as M,a as h,n as L,t as A,o as m,c as U,ak as S,u as g,i as k,b as s,e as v,h as K,a9 as J,w as $,m as T,r as V,F as E,l as j,g as z,k as Q,C as te,j as P,aa as oe,y as ne,R as Y,p as Z,al as re,f as ae,a4 as le,a6 as ie,s as X,am as ce}from"./index-BJM9FpXo.js";import{h as C,I as _}from"./client-D6K6htDN.js";import"./StacktraceViewer.vue_vue_type_style_index_0_scoped_7fdb99e3_lang-B8VJLqpg.js";import{n as R,i as de,a as ue,t as F,b as me,c as pe,d as fe,w as ge}from"./index-B9uLu0-5.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as ye}from"./users-BNnsnLpB.js";import{u as ve}from"./projects-CJzepl33.js";const be=["src","alt"],xe=M({__name:"Avatar",props:{name:{},src:{},size:{}},setup(t){function n(e){switch(e){case"xs":return"w-5 h-5";case"sm":return"w-8 h-8";case"md":return"w-10 h-10";case"lg":return"w-12 h-12";case"xl":return"w-16 h-16";case"2xl":return"w-20 h-20";case"3xl":return"w-24 h-24";case"4xl":return"w-32 h-32";case"5xl":return"w-40 h-40";default:return"w-10 h-10"}}return(e,a)=>{var r;return e.src?(m(),h("img",{key:0,class:L(["rounded-full",n(e.size)]),src:e.src,alt:e.name},null,10,be)):(m(),h("span",{key:1,class:L(["inline-flex items-center justify-center rounded-full bg-gray-100 text-indigo-600 font-bold",n(e.size)])},A((r=e.name)==null?void 0:r.charAt(0)),3))}}}),B={async getAll(){return C.get("/teams")},async get(t){return C.get(`/teams/${t}`)},async getAvailableUsers(t,n){return C.get(`/teams/${t}/available-users`,{query:{search:n}})},async create(t){return C.post("/teams",t)},async update(t,n){return C.put(`/teams/${t}`,n)},async delete(t){return C.delete(`/teams/${t}`)},async addMembers(t,n){return C.post(`/teams/${t}/members`,n)},async removeMember(t,n){return C.delete(`/teams/${t}/members/${n}`)}},ee=ue?window:void 0;function O(t){var n;const e=S(t);return(n=e==null?void 0:e.$el)!=null?n:e}function q(...t){const n=[],e=()=>{n.forEach(u=>u()),n.length=0},a=(u,i,o,p)=>(u.addEventListener(i,o,p),()=>u.removeEventListener(i,o,p)),r=U(()=>{const u=F(S(t[0])).filter(i=>i!=null);return u.every(i=>typeof i!="string")?u:void 0}),y=me(()=>{var u,i;return[(i=(u=r.value)==null?void 0:u.map(o=>O(o)))!=null?i:[ee].filter(o=>o!=null),F(S(r.value?t[1]:t[0])),F(g(r.value?t[2]:t[1])),S(r.value?t[3]:t[2])]},([u,i,o,p])=>{if(e(),!(u!=null&&u.length)||!(i!=null&&i.length)||!(o!=null&&o.length))return;const c=fe(p)?{...p}:p;n.push(...u.flatMap(f=>i.flatMap(x=>o.map(D=>a(f,x,D,c)))))},{flush:"post"}),l=()=>{y(),e()};return pe(e),l}let G=!1;function se(t,n,e={}){const{window:a=ee,ignore:r=[],capture:y=!0,detectIframe:l=!1,controls:u=!1}=e;if(!a)return u?{stop:R,cancel:R,trigger:R}:R;if(de&&!G){G=!0;const d={passive:!0};Array.from(a.document.body.children).forEach(b=>b.addEventListener("click",R,d)),a.document.documentElement.addEventListener("click",R,d)}let i=!0;const o=d=>S(r).some(b=>{if(typeof b=="string")return Array.from(a.document.querySelectorAll(b)).some(w=>w===d.target||d.composedPath().includes(w));{const w=O(b);return w&&(d.target===w||d.composedPath().includes(w))}});function p(d){const b=S(d);return b&&b.$.subTree.shapeFlag===16}function c(d,b){const w=S(d),N=w.$.subTree&&w.$.subTree.children;return N==null||!Array.isArray(N)?!1:N.some(W=>W.el===b.target||b.composedPath().includes(W.el))}const f=d=>{const b=O(t);if(d.target!=null&&!(!(b instanceof Element)&&p(t)&&c(t,d))&&!(!b||b===d.target||d.composedPath().includes(b))){if("detail"in d&&d.detail===0&&(i=!o(d)),!i){i=!0;return}n(d)}};let x=!1;const D=[q(a,"click",d=>{x||(x=!0,setTimeout(()=>{x=!1},0),f(d))},{passive:!0,capture:y}),q(a,"pointerdown",d=>{const b=O(t);i=!o(d)&&!!(b&&!d.composedPath().includes(b))},{passive:!0}),l&&q(a,"blur",d=>{setTimeout(()=>{var b;const w=O(t);((b=a.document.activeElement)==null?void 0:b.tagName)==="IFRAME"&&!(w!=null&&w.contains(a.document.activeElement))&&n(d)},0)},{passive:!0})].filter(Boolean),H=()=>D.forEach(d=>d());return u?{stop:H,cancel:()=>{i=!1},trigger:d=>{i=!0,f(d),i=!1}}:H}const _e=["aria-expanded"],we={key:0,class:"origin-top-right absolute right-10 mt-2 w-48 rounded-md shadow-lg bg-white border border-zinc-300 ring-opacity-5 focus:outline-none z-10"},ke={class:"py-1"},$e=["onClick"],Ce={key:1,class:"text-sm text-gray-400 p-1"},Ee=M({__name:"DropdownMenu",props:{actions:{default:()=>[{key:"create-issue",label:"Создать проблему",icon:"heroicons:plus-circle",iconClass:"text-blue-500"},{key:"delete",label:"Удалить",icon:"heroicons:trash",iconClass:"text-red-500"}]},menuKey:{},modelValue:{type:Boolean,default:void 0},row:{default:void 0},icon:{default:"heroicons:ellipsis-vertical"}},emits:["update:modelValue","action","open","close"],setup(t,{emit:n}){const e=t,a=n,r=k(null),y=k(!1),l=U({get(){return e.modelValue!==void 0?e.modelValue:y.value},set(c){e.modelValue!==void 0?a("update:modelValue",c):y.value=c,a(c?"open":"close")}}),u=U(()=>e.actions.filter(c=>typeof c.visible=="function"?c.visible(e.row):c.visible!==!1));se(r,()=>{l.value&&o()});const i=()=>{l.value=!l.value},o=()=>{l.value=!1},p=c=>{var f;a("action",{key:c.key,row:e.row}),(f=c.handler)==null||f.call(c,e.row),o()};return(c,f)=>(m(),h("div",{class:"flex justify-end relative",ref_key:"dropdownRef",ref:r},[s("button",{onClick:K(i,["stop"]),class:"text-gray-400 hover:text-gray-600 focus:outline-none cursor-pointer","aria-haspopup":"true","aria-expanded":l.value,"aria-label":"Действия"},[v(g(_),{icon:e.icon,class:"h-5 w-5"},null,8,["icon"])],8,_e),v(J,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:$(()=>[l.value?(m(),h("div",we,[s("div",ke,[u.value.length?V(c.$slots,"default",{key:0,row:c.row},()=>[(m(!0),h(E,null,j(u.value,x=>(m(),h("button",{key:x.key,onClick:K(D=>p(x),["stop"]),class:"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left cursor-pointer"},[v(g(_),{icon:x.icon,class:L(["mr-2 h-4 w-4",x.iconClass])},null,8,["icon","class"]),z(" "+A(x.label),1)],8,$e))),128))]):(m(),h("div",Ce," Нет доступных действий. "))])])):T("",!0)]),_:3})],512))}}),je={key:0,class:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title","aria-modal":"true",role:"dialog"},Le={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},Te={class:"bg-white px-4 pt-5 rounded-lg pb-4 sm:p-6 sm:pb-4"},Se={class:"sm:flex sm:items-start"},Me={class:"mt-3 text-center sm:mt-0 sm:text-left w-full"},Re={class:"text-lg leading-6 font-medium text-gray-900",id:"modal-title"},Ae={class:"mt-2"},Ie={key:0,class:"px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse z-10"},Oe=M({__name:"Modal",props:{isOpen:{type:Boolean,required:!0}},emits:["close"],setup(t,{emit:n}){const e=k(null),a=n,r=()=>{a("close")};se(e.value,()=>{r()});const y=l=>{l.key==="Escape"&&r()};return Q(()=>{document.addEventListener("keydown",y)}),te(()=>{document.removeEventListener("keydown",y)}),(l,u)=>(m(),P(J,{name:"modal"},{default:$(()=>[t.isOpen?(m(),h("div",je,[s("div",Le,[s("div",{class:"fixed inset-0 bg-gray-500/75 -z-10 backdrop-blur-sm transition-opacity","aria-hidden":"true",onClick:r}),u[0]||(u[0]=s("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),s("div",{ref_key:"modalRef",ref:e,class:"inline-block align-bottom bg-white rounded-lg text-left shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},[s("div",Te,[s("div",Se,[s("div",Me,[s("h3",Re,[V(l.$slots,"title",{},void 0,!0)]),s("div",Ae,[V(l.$slots,"content",{},void 0,!0)])])])]),l.$slots.footer?(m(),h("div",Ie,[V(l.$slots,"footer",{},void 0,!0)])):T("",!0)],512)])])):T("",!0)]),_:3}))}}),Ve=he(Oe,[["__scopeId","data-v-f0bc398a"]]),ze=oe("teams",()=>{const t=k([]),n=k({id:0,name:"none",slug:"",members:{},projects:{},assignments:{}}),e=k(!1),a=k(!1),r=async(o,p)=>{p.value=!0;try{await o()}finally{p.value=!1}},y=o=>{r(async()=>{n.value=await B.get(o)},a)},l=()=>r(async()=>{t.value=await B.getAll()},e);return{teams:t,team:n,isLoading:a,isLoadingTeams:e,fetchTeam:y,fetchTeams:l,create:o=>r(async()=>{await B.create(o),await ne.push({path:Y.TEAM.INDEX})},a),destroy:o=>r(async()=>{await B.delete(o),await l()},a)}}),I=["bg-indigo-500","bg-indigo-600","bg-green-500","bg-green-600","bg-emerald-500","bg-emerald-600","bg-teal-500","bg-teal-600","bg-cyan-500","bg-cyan-600","bg-blue-500","bg-blue-600","bg-sky-500","bg-sky-600","bg-violet-500","bg-violet-600","bg-purple-500","bg-purple-600","bg-fuchsia-500","bg-fuchsia-600","bg-pink-500","bg-pink-600","bg-rose-500","bg-rose-600","bg-red-500","bg-red-600","bg-orange-500","bg-orange-600","bg-amber-500","bg-amber-600","bg-yellow-500","bg-yellow-600","bg-lime-500","bg-lime-600"],Pe=()=>({getColor:e=>{const a=e.split("").reduce((y,l,u)=>l.charCodeAt(0)*(u+1)+((y<<5)-y),0),r=Math.abs(a)%I.length;return I[r]},getColorByIndex:e=>I[Math.abs(e)%I.length],colors:U(()=>I)}),De={class:"flex items-center gap-4"},Be={key:0},Ue={key:1},Ne={key:2},Fe={key:3},qe={class:"text-sm text-gray-700 font-medium"},He={class:"text-sm text-gray-500"},We=M({__name:"SearchItem",props:{item:{}},setup(t){const n=e=>{if(e.type==="issue")return`/issues/${e.id}`;if(e.type==="project")return`/projects/${e.slug}`;if(e.type==="team")return`/teams/${e.slug}`;if(e.type==="event")return`/events/${e.id}`};return(e,a)=>{const r=Z("RouterLink");return m(),P(r,{class:"flex items-center justify-between cursor-pointer space-x-2 border border-gray-200 rounded-md p-3 shadow-xs mt-2",to:n(e.item)},{default:$(()=>{var y;return[s("div",De,[e.item.type==="issue"?(m(),h("span",Be,[v(g(_),{icon:"heroicons:document-text",class:"h-5 w-5 text-gray-500"})])):T("",!0),e.item.type==="project"?(m(),h("span",Ue,[v(g(_),{icon:"heroicons:folder",class:"h-5 w-5 text-gray-500"})])):T("",!0),e.item.type==="event"?(m(),h("span",Ne,[v(g(_),{icon:"heroicons:calendar",class:"h-5 w-5 text-gray-500"})])):T("",!0),e.item.type==="team"?(m(),h("span",Fe,[v(g(_),{icon:"heroicons:users",class:"h-5 w-5 text-gray-500"})])):T("",!0),s("span",qe,A(((y=e.item)==null?void 0:y.title)??e.item.name??e.item.message),1)]),s("span",He,[v(g(_),{icon:"heroicons:chevron-right",class:"h-5 w-5"})])]}),_:1},8,["to"])}}}),Ke={class:"bg-white shadow-sm h-16 flex items-center border-b border-gray-200"},Xe={class:"w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Ge={class:"flex justify-between items-center"},Je={class:"flex-1 flex justify-end items-center space-x-4"},Qe={class:"relative max-w-md w-full"},Ye={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},Ze=["disabled"],es={class:"relative"},ss={class:"flex items-center space-x-2"},ts={class:"relative"},os={class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},ns={class:"flex flex-col space-y-1"},rs={key:1},as={class:"flex items-center justify-center space-x-2 mt-4"},ls={key:2,class:"flex items-center justify-center space-x-2 mt-4"},is=M({__name:"DashboardHeader",setup(t){const n=ye(),e=ae(),a=k(""),r=k([]),y=k(!1),l=k(!1),u=[{icon:"heroicons:user-circle",key:"profile",label:"Профиль",handler:async()=>{l.value=!1,await e.push(Y.USER.PROFILE)}},{icon:"heroicons:arrow-right-end-on-rectangle",key:"logout",label:"Выйти",handler:async()=>{l.value=!1,await n.logout()}}];return ge(a,async i=>{if(!i.trim()){r.value=[];return}y.value=!0;try{r.value=(await C.get(`/search?search=${encodeURIComponent(i)}`)).data}catch(o){console.error("Ошибка поиска:",o),r.value=[]}finally{y.value=!1}},{debounce:300}),(i,o)=>{var p;return m(),h(E,null,[s("header",Ke,[s("div",Xe,[s("div",Ge,[o[3]||(o[3]=s("div",{class:"w-64"},null,-1)),s("div",Je,[s("div",Qe,[s("div",Ye,[v(g(_),{icon:"heroicons:magnifying-glass",class:"h-5 w-5 text-gray-500"})]),s("input",{placeholder:"Искать проект, задачу, команду...",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",onClick:o[0]||(o[0]=c=>l.value=!0),disabled:l.value},null,8,Ze)]),s("div",es,[s("div",ss,[v(g(xe),{name:(p=g(n).currentUser)==null?void 0:p.name,size:"sm"},null,8,["name"]),v(g(Ee),{icon:"heroicons:chevron-down",actions:u})])])])])])]),(m(),P(re,{to:"body"},[v(g(Ve),{"is-open":l.value,onClose:o[2]||(o[2]=c=>l.value=!1)},{title:$(()=>o[4]||(o[4]=[z("Поиск")])),content:$(()=>[s("div",ts,[le(s("input",{"onUpdate:modelValue":o[1]||(o[1]=c=>a.value=c),type:"text",placeholder:"Поиск",class:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,512),[[ie,a.value]]),s("div",os,[v(g(_),{icon:"heroicons:magnifying-glass",class:"h-5 w-5 text-gray-500"})])]),r.value.length?(m(!0),h(E,{key:0},j(r.value,c=>(m(),h("div",ns,[v(We,{item:c},null,8,["item"])]))),256)):y.value&&!r.value.length?(m(),h("div",rs,[s("div",as,[v(g(_),{icon:"heroicons:sparkles",class:"h-5 w-5 text-gray-500"}),o[5]||(o[5]=s("span",{class:"text-gray-500 text-sm"},"Поиск...",-1))])])):(m(),h("div",ls,[v(g(_),{icon:"heroicons:sparkles",class:"h-5 w-5 text-gray-500"}),o[6]||(o[6]=s("span",{class:"text-gray-500 text-sm"},"Ничего не найдено",-1))]))]),_:1},8,["is-open"])]))],64)}}}),cs={class:"flex flex-col w-64 border-r border-gray-200 bg-white h-full"},ds={class:"flex-1 px-2 py-4 space-y-1 overflow-y-auto"},us={class:"px-3 py-4 border-t border-gray-200"},ms={class:"flex items-center justify-between mb-2"},ps={class:"space-y-1"},fs={class:"px-3 py-4 border-t border-gray-200"},gs={class:"flex items-center justify-between mb-2"},hs={class:"space-y-1"},ys=M({__name:"DashboardSidebar",setup(t){const n=[{name:"Dashboard",to:"/dashboard",icon:"heroicons:home"},{name:"Задачи",to:"/issues",icon:"heroicons:document-text"},{name:"Команды",to:"/teams",icon:"heroicons:users"},{name:"Проекты",to:"/projects",icon:"heroicons:folder-open"},{name:"Пользователи",to:"/users",icon:"heroicons:user-group"}],e=ve(),{projects:a,isLoading:r}=X(e),y=ze(),{teams:l,isLoadingTeams:u}=X(y),{getColor:i}=Pe();return Q(async()=>{await e.fetchProjects(),await y.fetchTeams()}),(o,p)=>{const c=Z("RouterLink");return m(),h("aside",cs,[p[4]||(p[4]=ce('<div class="flex items-center h-16 px-4 border-b border-gray-200"><div class="flex items-center"><div class="flex-shrink-0 flex items-center justify-center h-10 w-10 rounded-md bg-indigo-600 text-white"><span class="text-lg font-medium">H</span></div><div class="ml-3"><p class="text-sm font-medium text-gray-900">Hound</p></div></div></div>',1)),s("nav",ds,[(m(),h(E,null,j(n,f=>v(c,{key:f.name,to:f.to},{default:$(({isActive:x})=>[s("span",{class:L([x?"bg-indigo-50 text-indigo-700":"text-gray-600 hover:bg-gray-50","group flex items-center px-3 py-2 text-sm font-medium rounded-md"])},[v(g(_),{icon:f.icon,class:L([x?"text-indigo-500":"text-gray-400 group-hover:text-gray-500","mr-3 h-5 w-5"])},null,8,["icon","class"]),z(" "+A(f.name),1)],2)]),_:2},1032,["to"])),64))]),s("div",us,[s("div",ms,[p[0]||(p[0]=s("span",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Проекты",-1)),v(c,{to:"/projects/create",class:"text-gray-400 hover:text-gray-500"},{default:$(()=>[v(g(_),{icon:"heroicons:plus",class:"h-4 w-4"})]),_:1})]),s("div",ps,[g(r)?(m(),h(E,{key:0},j(3,f=>s("div",{key:`project-skeleton-${f}`,class:"animate-pulse"},p[1]||(p[1]=[s("div",{class:"group flex items-center px-3 py-2 text-sm font-medium text-gray-600 rounded-md"},[s("span",{class:"w-2.5 h-2.5 mr-3 rounded-full bg-gray-200"}),s("div",{class:"h-4 bg-gray-200 rounded w-3/4"})],-1)]))),64)):(m(!0),h(E,{key:1},j(g(a),f=>(m(),P(c,{key:f.id,class:"group flex items-center px-3 py-2 text-sm font-medium text-gray-600 rounded-md hover:bg-gray-50",to:`/projects/${f.slug}`},{default:$(()=>[s("span",{class:L(["w-2.5 h-2.5 mr-3 rounded-full",g(i)(f.name)])},null,2),z(" "+A(f.name),1)]),_:2},1032,["to"]))),128))])]),s("div",fs,[s("div",gs,[p[2]||(p[2]=s("span",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wider"},"Команды",-1)),v(c,{to:"/teams/create",class:"text-gray-400 hover:text-gray-500"},{default:$(()=>[v(g(_),{icon:"heroicons:plus",class:"h-4 w-4"})]),_:1})]),s("div",hs,[g(u)?(m(),h(E,{key:0},j(3,f=>s("div",{key:`team-skeleton-${f}`,class:"animate-pulse"},p[3]||(p[3]=[s("div",{class:"group flex items-center px-3 py-2 text-sm font-medium text-gray-600 rounded-md"},[s("span",{class:"w-2.5 h-2.5 mr-3 rounded-full bg-gray-200"}),s("div",{class:"h-4 bg-gray-200 rounded w-3/4"})],-1)]))),64)):(m(!0),h(E,{key:1},j(g(l),f=>(m(),P(c,{key:f.id,class:"group flex items-center px-3 py-2 text-sm font-medium text-gray-600 rounded-md hover:bg-gray-50",to:`/teams/${f.slug}`},{default:$(()=>[s("span",{class:L(["w-2.5 h-2.5 mr-3 rounded-full",g(i)(f.name)])},null,2),z(" "+A(f.name),1)]),_:2},1032,["to"]))),128))])])])}}}),vs={class:"h-screen flex flex-col"},bs={class:"flex flex-1 overflow-hidden"},xs={class:"flex-1 flex flex-col overflow-hidden"},_s={class:"flex-1 overflow-y-auto bg-gray-50"},ws={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6"},Ss=M({__name:"DashboardLayout",setup(t){return(n,e)=>(m(),h("div",vs,[s("div",bs,[v(ys),s("div",xs,[v(is),s("main",_s,[s("div",ws,[V(n.$slots,"default")])])])])]))}});export{Ve as M,B as T,xe as _,Ss as a,ze as b,Ee as c,Pe as u};
