import{d as S,a as w,o as d,b as t,p as z,e as n,f as i,w as l,h as u,t as p,s as M,j as N,k as _,m as O,B as W,C as I,l as y,i as L,x as D,q as F,n as R,F as T,g as G}from"./index-COMv6etk.js";import{a as J,M as A}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-CHJqekDv.js";import{I as m}from"./iconify-C3uGCOZ5.js";import{_ as K}from"./SelectField.vue_vue_type_script_setup_true_lang-KwghT8h_.js";import{_ as B}from"./InputField.vue_vue_type_script_setup_true_lang-CF7Aq3Tc.js";import{_ as C}from"./Button.vue_vue_type_script_setup_true_lang-DLUYOOAu.js";import"./index-BCqgpTI_.js";import{_ as H}from"./Badge.vue_vue_type_script_setup_true_lang-Ct279txg.js";import{_ as P}from"./EmptyState.vue_vue_type_script_setup_true_lang-nYcZASKD.js";import{_ as Q}from"./IssueItem.vue_vue_type_script_setup_true_lang-CS198Ilz.js";import{f as X,a as Y}from"./index-bfLnkGmT.js";import{S as E}from"./StatCard-aoHjfvX-.js";import{u as Z,i as ee,a as te,b as se,c as oe,d as ne,e as ie,f as ae,h as le,j as re}from"./install-w9194OeT.js";import"./index-ClJfUPhm.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./projects-BLnA6f_-.js";import"./platforms-D8ztvdxx.js";const de={class:"px-5 py-4 hover:bg-gray-50 transition-colors duration-150"},ce={class:"flex items-center justify-between"},ue={class:"flex items-center space-x-3 min-w-0"},me={class:"min-w-0"},pe={class:"mt-1 flex items-center space-x-3"},ve={class:"text-xs text-gray-500"},ge={class:"text-xs text-gray-500"},fe={class:"flex items-center space-x-4"},he=S({__name:"EndpointItem",props:{endpoint:{}},emits:["delete"],setup($){return(s,v)=>{const o=M("RouterLink");return d(),w("div",de,[t("div",ce,[t("div",ue,[t("div",{class:z(["flex-shrink-0",{"text-green-500":s.endpoint.is_active,"text-red-500":!s.endpoint.is_active}])},[n(i(m),{icon:s.endpoint.is_active?"heroicons:check-circle":"heroicons:x-circle",class:"h-5 w-5"},null,8,["icon"])],2),t("div",me,[n(o,{to:`/healthcheck/${s.endpoint.id}/results`,class:"text-sm font-medium text-gray-900 truncate"},{default:l(()=>[u(p(s.endpoint.url),1)]),_:1},8,["to"]),t("div",pe,[t("span",ve," HTTP "+p(s.endpoint.expected_status),1),t("span",ge," Каждые "+p(s.endpoint.interval)+" мин ",1)])])]),t("div",fe,[t("button",{onClick:v[0]||(v[0]=N(g=>s.$emit("delete",s.endpoint.id),["stop"])),class:"text-gray-400 hover:text-red-500"},[n(i(m),{icon:"heroicons:trash",class:"h-4 w-4 cursor-pointer"})])])])])}}}),xe={class:"px-5 py-4 hover:bg-gray-50 transition-colors duration-150"},ye={class:"flex items-start space-x-3"},_e={class:"min-w-0 flex-1"},be={class:"text-sm font-medium text-gray-900 truncate"},we={class:"mt-1 flex flex-wrap items-center gap-x-3 gap-y-1"},$e={class:"text-xs text-gray-500"},ke=S({__name:"EventItem",props:{event:{},projectSlug:{}},setup($){return(s,v)=>{const o=M("RouterLink");return d(),w("div",xe,[t("div",ye,[t("div",{class:z(["flex-shrink-0 mt-1",{"text-red-500":s.event.level==="error"||s.event.level==="critical","text-amber-500":s.event.level==="warning","text-gray-500":s.event.level==="info"}])},[n(i(m),{icon:{critical:"heroicons:exclamation-triangle",error:"heroicons:exclamation-circle",warning:"heroicons:exclamation-circle",info:"heroicons:information-circle"}[s.event.level],class:"h-5 w-5"},null,8,["icon"])],2),t("div",_e,[t("p",be,p(s.event.message),1),t("div",we,[t("span",$e,p(i(X)(s.event.created_at)),1),t("span",{class:z(["inline-flex items-center px-2 py-0.5 rounded text-xs font-medium",{"bg-red-100 text-red-800":s.event.level==="error"||s.event.level==="critical","bg-amber-100 text-amber-800":s.event.level==="warning","bg-blue-100 text-blue-800":s.event.level==="info"}])},p(s.event.level),3)])]),n(o,{to:`/events/${s.event.id}`,class:"text-gray-400 hover:text-gray-500"},{default:l(()=>[n(i(m),{icon:"heroicons:chevron-right",class:"h-5 w-5"})]),_:1},8,["to"])])])}}}),je=S({__name:"LineChart",props:{data:{type:Array,required:!0},title:{type:String,default:""}},setup($){Z([te,se,oe,ne,ie,ae,le,re]);const s=$,v=_(null);let o=null;const g=()=>{v.value&&(o=ee(v.value),b())},b=()=>{if(!o)return;const h=Math.max(...s.data.map(e=>e.total)),r=Math.ceil(h*1.2),k=s.data.map(e=>e.date),V=s.data.map(e=>e.errors),j=s.data.map(e=>e.warnings),c={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:e=>{const x=e[0].data;return`
          <div class="text-gray-900 font-medium">${e[0].axisValue}</div>
          <div class="mt-2 space-y-1">
            <div class="flex items-center">
              <span class="inline-block w-3 h-3 rounded-full mr-2 bg-[#6366F1]"></span>
              <span>Всего: <strong>${x.total}</strong></span>
            </div>
            <div class="flex items-center">
              <span class="inline-block w-3 h-3 rounded-full mr-2 bg-[#EF4444]"></span>
              <span>Ошибки: <strong>${x.errors}</strong></span>
            </div>
            <div class="flex items-center">
              <span class="inline-block w-3 h-3 rounded-full mr-2 bg-[#F59E0B]"></span>
              <span>Предупреждения: <strong>${x.warnings}</strong></span>
            </div>
          </div>
        `}},legend:{data:["Всего","Ошибки","Предупреждения"],bottom:0},grid:{left:"3%",right:"4%",bottom:"15%",top:s.title?"10%":"5%",containLabel:!0},xAxis:{type:"category",data:k,axisLine:{lineStyle:{color:"#E5E7EB"}},axisLabel:{color:"#6B7280"}},yAxis:{max:r,type:"value",axisLine:{show:!1},axisTick:{show:!1},splitLine:{lineStyle:{color:"#F3F4F6"}},axisLabel:{color:"#6B7280"}},series:[{name:"Всего",type:"bar",barWidth:"60%",itemStyle:{color:"#6366F1",borderRadius:[12,12,0,0]},data:s.data.map(e=>({value:e.total,total:e.total,errors:e.errors,warnings:e.warnings}))},{name:"Ошибки",type:"line",smooth:!0,symbolSize:8,lineStyle:{width:3,color:"#EF4444"},itemStyle:{color:"#EF4444",borderWidth:2,borderColor:"#fff"},data:V},{name:"Предупреждения",type:"line",smooth:!0,symbolSize:8,lineStyle:{width:3,color:"#F59E0B"},itemStyle:{color:"#F59E0B",borderWidth:2,borderColor:"#fff"},data:j}],...s.title&&{title:{text:s.title,left:"center",textStyle:{color:"#111827",fontWeight:"normal",fontSize:14}}}};o.setOption(c)},f=()=>{o==null||o.resize()};return O(()=>{g(),window.addEventListener("resize",f)}),W(()=>{window.removeEventListener("resize",f),o==null||o.dispose()}),I(()=>s.data,()=>{b()},{deep:!0}),I(()=>s.color,()=>{b()}),(h,r)=>(d(),w("div",{ref_key:"chartRef",ref:v,class:"w-full h-[300px]"},null,512))}}),Ce={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8"},Ee={class:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4"},Se={class:"flex items-start space-x-4"},Ve={class:"p-3 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-xl shadow-md"},Le={class:"text-2xl font-bold text-gray-900"},Fe={class:"flex flex-wrap items-center gap-2 mt-2"},Re={class:"flex space-x-3"},Te={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},Be={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},Pe={class:"lg:col-span-2 space-y-6"},ze={class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"},Me={class:"p-6"},Ue={class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"},qe={class:"px-6 py-5 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white flex items-center justify-between"},Ie={class:"divide-y divide-gray-100"},Ae={class:"space-y-6"},He={class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"},Ne={class:"px-6 py-5 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white flex items-center justify-between"},Oe={class:"divide-y divide-gray-100"},We={class:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden"},De={class:"px-6 py-5 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white flex items-center justify-between"},Ge={class:"divide-y divide-gray-100"},Je={class:"text-center"},Ke={class:"mt-2 text-sm text-gray-500"},Qe={class:"flex justify-end gap-3"},Xe={class:"flex justify-end gap-3"},gt=S({__name:"Show",setup($){const s=D(),v=G(),o=_({id:0,name:"",slug:"",platform:"",team:{name:""},events:[],issues:[],endpoints:[],notificationRules:[]}),g=_({events_today:0,events_week:0,active_issues:0,uptime_percentage:100}),b=_([]),f=_(!1),h=_(!1),r=_({url:"",expected_status:200,interval:5,method:"GET",is_active:!0}),k=async()=>{try{const c=await L.get(`/projects/${s.params.slug}`);o.value=c.project,g.value=c.stats,b.value=c.daily_stats}catch(c){console.error("Error fetching project:",c)}},V=async()=>{try{await L.delete(`/projects/${o.value.id}`),await v.push("/projects")}catch(c){console.error("Error deleting project:",c)}finally{f.value=!1}},j=async()=>{try{await L.post(`/healthcheck/${o.value.slug}`,r.value),await k(),h.value=!1,r.value={url:"",expected_status:200,interval:5,method:"GET",is_active:!0}}catch(c){console.error("Error adding endpoint:",c)}};return O(()=>{k()}),(c,e)=>{const x=M("RouterLink");return d(),y(J,null,{default:l(()=>{var U,q;return[t("div",Ce,[t("div",Ee,[t("div",Se,[t("div",Ve,[n(i(m),{icon:i(Y)(o.value.platform),class:"h-8 w-8 text-white"},null,8,["icon"])]),t("div",null,[t("h1",Le,p(o.value.name),1),t("div",Fe,[n(i(H),{variant:"primary",class:"flex items-center"},{default:l(()=>[n(i(m),{icon:"heroicons:user-group",class:"mr-1 h-4 w-4"}),u(" "+p(o.value.team.name),1)]),_:1}),n(i(H),{variant:"secondary",class:"flex items-center"},{default:l(()=>[n(i(m),{icon:"heroicons:computer-desktop",class:"mr-1 h-4 w-4"}),u(" "+p(o.value.platform),1)]),_:1})])])]),t("div",Re,[n(x,{to:`/projects/${o.value.slug}/settings/general`,class:"inline-flex items-center px-4 py-2 bg-white border border-gray-200 text-gray-700 text-sm font-medium rounded-lg shadow-sm hover:bg-gray-50 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"},{default:l(()=>[n(i(m),{icon:"heroicons:cog-6-tooth",class:"mr-2 h-4 w-4"}),e[10]||(e[10]=u(" Настройки "))]),_:1},8,["to"]),t("button",{onClick:e[0]||(e[0]=a=>f.value=!0),class:"inline-flex items-center px-4 py-2 cursor-pointer bg-white border border-gray-200 text-red-600 text-sm font-medium rounded-lg shadow-sm hover:bg-red-50 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2"},[n(i(m),{icon:"heroicons:trash",class:"mr-2 h-4 w-4"}),e[11]||(e[11]=u(" Удалить "))])])]),t("div",Te,[n(E,{title:"Событий сегодня",value:g.value.events_today,icon:"heroicons:bell-alert"},null,8,["value"]),n(E,{title:"Событий за неделю",value:g.value.events_week,icon:"heroicons:calendar-days"},null,8,["value"]),n(E,{title:"Активных задач",value:g.value.active_issues,icon:"heroicons:exclamation-triangle",variant:"warning"},null,8,["value"]),n(E,{title:"Uptime",value:`${(q=(U=g.value)==null?void 0:U.uptime_percentage)==null?void 0:q.toFixed(2)}%`,icon:"heroicons:shield-check",variant:"success"},null,8,["value"])]),t("div",Be,[t("div",Pe,[t("div",ze,[e[12]||(e[12]=t("div",{class:"px-6 py-5 border-b border-gray-100 bg-gradient-to-r from-gray-50 to-white"},[t("h2",{class:"text-lg font-semibold text-gray-900"},"Активность (7 дней)")],-1)),t("div",Me,[n(je,{data:b.value,title:"Активность событий",color:"#8B5CF6","show-mark-line":!0},null,8,["data"])])]),t("div",Ue,[t("div",qe,[e[14]||(e[14]=t("h2",{class:"text-lg font-semibold text-gray-900"},"Последние события",-1)),n(x,{to:`/projects/${o.value.slug}/events`,class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"},{default:l(()=>e[13]||(e[13]=[u(" Показать все ")])),_:1},8,["to"])]),t("div",Ie,[(d(!0),w(T,null,R(o.value.events,a=>(d(),y(ke,{key:a.id,event:a,class:"hover:bg-gray-50 transition-colors duration-150","project-slug":o.value.slug},null,8,["event","project-slug"]))),128)),o.value.events.length?F("",!0):(d(),y(i(P),{key:0,title:"Событий не найдено",icon:"heroicons:bell",description:"Здесь будут отображаться последние события вашего проекта.",class:"p-6",small:""}))])])]),t("div",Ae,[t("div",He,[t("div",Ne,[e[15]||(e[15]=t("h2",{class:"text-lg font-semibold text-gray-900"},"Health Check Endpoints",-1)),t("button",{onClick:e[1]||(e[1]=a=>h.value=!0),class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium cursor-pointer"},[n(i(m),{icon:"heroicons:plus",class:"h-4 w-4"})])]),t("div",Oe,[(d(!0),w(T,null,R(o.value.endpoints,a=>(d(),y(he,{slug:o.value.slug,key:a.id,endpoint:a,class:"hover:bg-gray-50 transition-colors duration-150"},null,8,["slug","endpoint"]))),128)),o.value.endpoints.length?F("",!0):(d(),y(i(P),{key:0,title:"Нет endpoints",icon:"heroicons:link",description:"Добавьте health check endpoints для мониторинга.",class:"p-6",small:""}))])]),t("div",We,[t("div",De,[e[17]||(e[17]=t("h2",{class:"text-lg font-semibold text-gray-900"},"Последние проблемы",-1)),n(x,{to:`/projects/${o.value.slug}/issues`,class:"text-sm text-indigo-600 hover:text-indigo-800 font-medium"},{default:l(()=>e[16]||(e[16]=[u(" Показать все ")])),_:1},8,["to"])]),t("div",Ge,[(d(!0),w(T,null,R(o.value.issues,a=>(d(),y(Q,{key:a.id,issue:a,class:"hover:bg-gray-50 transition-colors duration-150","project-slug":o.value.slug},null,8,["issue","project-slug"]))),128)),o.value.issues.length?F("",!0):(d(),y(i(P),{key:0,title:"Проблем не найдено",icon:"heroicons:check-badge",description:"Отличная работа! Активных проблем нет.",class:"p-6",small:""}))])])])])]),n(i(A),{"is-open":f.value,onClose:e[3]||(e[3]=a=>f.value=!1),title:"Подтверждение удаления"},{content:l(()=>[t("div",Je,[n(i(m),{icon:"heroicons:exclamation-triangle",class:"mx-auto h-12 w-12 text-red-500"}),e[19]||(e[19]=t("h3",{class:"mt-2 text-lg font-medium text-gray-900"},"Удалить проект?",-1)),t("div",Ke,[t("p",null,'Вы уверены, что хотите удалить проект "'+p(o.value.name)+'"?',1),e[18]||(e[18]=t("p",{class:"mt-1"},"Это действие нельзя отменить.",-1))])])]),footer:l(()=>[t("div",Qe,[n(i(C),{variant:"secondary",onClick:e[2]||(e[2]=a=>f.value=!1)},{default:l(()=>e[20]||(e[20]=[u(" Отмена ")])),_:1}),n(i(C),{variant:"danger",onClick:V},{default:l(()=>e[21]||(e[21]=[u(" Удалить ")])),_:1})])]),_:1},8,["is-open"]),n(i(A),{"is-open":h.value,onClose:e[9]||(e[9]=a=>h.value=!1),title:"Добавить Health Check Endpoint"},{content:l(()=>[t("form",{onSubmit:N(j,["prevent"]),class:"space-y-4"},[n(i(B),{id:"endpoint-url",modelValue:r.value.url,"onUpdate:modelValue":e[4]||(e[4]=a=>r.value.url=a),label:"URL Endpoint",placeholder:"https://example.com/health",required:"",icon:"heroicons:link"},null,8,["modelValue"]),n(i(B),{id:"exp-status",modelValue:r.value.expected_status,"onUpdate:modelValue":e[5]||(e[5]=a=>r.value.expected_status=a),label:"Ожидаемый HTTP статус",type:"number",placeholder:"200",required:"",icon:"heroicons:hashtag"},null,8,["modelValue"]),n(i(B),{modelValue:r.value.interval,"onUpdate:modelValue":e[6]||(e[6]=a=>r.value.interval=a),label:"Интервал проверки (минуты)",type:"number",placeholder:"5",required:"",icon:"heroicons:clock",id:"check-interval"},null,8,["modelValue"]),n(i(K),{options:["GET","POST","PUT","PATCH","OPTIONS"],modelValue:r.value.method,"onUpdate:modelValue":e[7]||(e[7]=a=>r.value.method=a),label:"Метод",required:""},null,8,["modelValue"])],32)]),footer:l(()=>[t("div",Xe,[n(i(C),{variant:"secondary",onClick:e[8]||(e[8]=a=>h.value=!1)},{default:l(()=>e[22]||(e[22]=[u(" Отмена ")])),_:1}),n(i(C),{onClick:j},{default:l(()=>e[23]||(e[23]=[u(" Добавить ")])),_:1})])]),_:1},8,["is-open"])]}),_:1})}}});export{gt as default};
