import{d as E,k as _,a as x,o as $,r as j,j as w}from"./index-DkP3bkHo.js";var c;function d(e){return{lang:(e==null?void 0:e.lang)??(c==null?void 0:c.lang),message:e==null?void 0:e.message,abortEarly:(e==null?void 0:e.abortEarly)??(c==null?void 0:c.abortEarly),abortPipeEarly:(e==null?void 0:e.abortPipeEarly)??(c==null?void 0:c.abortPipeEarly)}}var v;function P(e){return v==null?void 0:v.get(e)}var b;function S(e){return b==null?void 0:b.get(e)}var h;function I(e,r){var n;return(n=h==null?void 0:h.get(e))==null?void 0:n.get(r)}function M(e){var n,s;const r=typeof e;return r==="string"?`"${e}"`:r==="number"||r==="bigint"||r==="boolean"?`${e}`:r==="object"||r==="function"?(e&&((s=(n=Object.getPrototypeOf(e))==null?void 0:n.constructor)==null?void 0:s.name))??"null":r}function o(e,r,n,s,i){const l=i&&"input"in i?i.input:n.value,u=(i==null?void 0:i.expected)??e.expects??null,t=(i==null?void 0:i.received)??M(l),a={kind:e.kind,type:e.type,input:l,expected:u,received:t,message:`Invalid ${r}: ${u?`Expected ${u} but r`:"R"}eceived ${t}`,requirement:e.requirement,path:i==null?void 0:i.path,issues:i==null?void 0:i.issues,lang:s.lang,abortEarly:s.abortEarly,abortPipeEarly:s.abortPipeEarly},p=e.kind==="schema",f=(i==null?void 0:i.message)??e.message??I(e.reference,a.lang)??(p?S(a.lang):null)??s.message??P(a.lang);f!==void 0&&(a.message=typeof f=="function"?f(a):f),p&&(n.typed=!1),n.issues?n.issues.push(a):n.issues=[a]}function m(e){return{version:1,vendor:"valibot",validate(r){return e["~run"]({value:r},d())}}}var k=class extends Error{constructor(e){super(e[0].message),this.name="ValiError",this.issues=e}},q=/^[\w+-]+(?:\.[\w+-]+)*@[\da-z]+(?:[.-][\da-z]+)*\.[a-z]{2,}$/iu;function D(e){return{kind:"validation",type:"email",reference:D,expects:null,async:!1,requirement:q,message:e,"~run"(r,n){return r.typed&&!this.requirement.test(r.value)&&o(this,"email",r,n),r}}}function N(e,r){return{kind:"validation",type:"min_length",reference:N,async:!1,expects:`>=${e}`,requirement:e,message:r,"~run"(n,s){return n.typed&&n.value.length<this.requirement&&o(this,"length",n,s,{received:`${n.value.length}`}),n}}}function V(e,r){var n;if(e.issues)for(const s of r)for(const i of e.issues){let l=!1;const u=Math.min(s.length,((n=i.path)==null?void 0:n.length)??0);for(let t=0;t<u;t++)if(s[t]!==i.path[t].key&&(s[t]!=="$"||i.path[t].type!=="array")){l=!0;break}if(!l)return!1}return!0}function z(e,r,n){return{kind:"validation",type:"partial_check",reference:z,async:!1,expects:null,paths:e,requirement:r,message:n,"~run"(s,i){return(s.typed||V(s,e))&&!this.requirement(s.value)&&o(this,"input",s,i),s}}}function C(e,r,n){return typeof e.fallback=="function"?e.fallback(r,n):e.fallback}function A(e,r){return{...e,"~run"(n,s){const i=n.issues&&[...n.issues];if(n=e["~run"](n,s),n.issues){for(const l of n.issues)if(!(i!=null&&i.includes(l))){let u=n.value;for(const t of r){const a=u[t],p={type:"unknown",origin:"value",input:u,key:t,value:a};if(l.path?l.path.push(p):l.path=[p],!a)break;u=a}}}return n}}}function g(e,r,n){return typeof e.default=="function"?e.default(r,n):e.default}function F(e){return{kind:"schema",type:"date",reference:F,expects:"Date",async:!1,message:e,get"~standard"(){return m(this)},"~run"(r,n){return r.value instanceof Date?isNaN(r.value)?o(this,"type",r,n,{received:'"Invalid Date"'}):r.typed=!0:o(this,"type",r,n),r}}}function G(e){return{kind:"schema",type:"number",reference:G,expects:"number",async:!1,message:e,get"~standard"(){return m(this)},"~run"(r,n){return typeof r.value=="number"&&!isNaN(r.value)?r.typed=!0:o(this,"type",r,n),r}}}function O(e,r){return{kind:"schema",type:"object",reference:O,expects:"Object",async:!1,entries:e,message:r,get"~standard"(){return m(this)},"~run"(n,s){var l;const i=n.value;if(i&&typeof i=="object"){n.typed=!0,n.value={};for(const u in this.entries){const t=this.entries[u];if(u in i||(t.type==="exact_optional"||t.type==="optional"||t.type==="nullish")&&t.default!==void 0){const a=u in i?i[u]:g(t),p=t["~run"]({value:a},s);if(p.issues){const f={type:"object",origin:"value",input:i,key:u,value:a};for(const y of p.issues)y.path?y.path.unshift(f):y.path=[f],(l=n.issues)==null||l.push(y);if(n.issues||(n.issues=p.issues),s.abortEarly){n.typed=!1;break}}p.typed||(n.typed=!1),n.value[u]=p.value}else if(t.fallback!==void 0)n.value[u]=C(t);else if(t.type!=="exact_optional"&&t.type!=="optional"&&t.type!=="nullish"&&(o(this,"key",n,s,{input:void 0,expected:`"${u}"`,path:[{type:"object",origin:"key",input:i,key:u,value:i[u]}]}),s.abortEarly))break}}else o(this,"type",n,s);return n}}}function B(e,r){return{kind:"schema",type:"optional",reference:B,expects:`(${e.expects} | undefined)`,async:!1,wrapped:e,default:r,get"~standard"(){return m(this)},"~run"(n,s){return n.value===void 0&&(this.default!==void 0&&(n.value=g(this,n,s)),n.value===void 0)?(n.typed=!0,n):this.wrapped["~run"](n,s)}}}function L(e){return{kind:"schema",type:"string",reference:L,expects:"string",async:!1,message:e,get"~standard"(){return m(this)},"~run"(r,n){return typeof r.value=="string"?r.typed=!0:o(this,"type",r,n),r}}}function R(e,r,n){const s=e["~run"]({value:r},d(n));if(s.issues)throw new k(s.issues);return s.value}function X(...e){return{...e[0],pipe:e,get"~standard"(){return m(this)},"~run"(r,n){for(const s of e)if(s.kind!=="metadata"){if(r.issues&&(s.kind==="schema"||s.kind==="transformation")){r.typed=!1;break}(!r.issues||!n.abortEarly&&!n.abortPipeEarly)&&(r=s["~run"](r,n))}return r}}}const H=E({__name:"TheForm",props:{schema:{},submit:{type:Function},data:{}},emits:["submit"],setup(e,{emit:r}){const n=e,s=r,i=_({});async function l(){try{i.value={};const t=await R(n.schema,n.data);await n.submit(t),s("submit",t)}catch(t){if(t instanceof k)i.value=u(t);else throw t}}function u(t){const a={};return t.issues.forEach(p=>{if(p.path){const f=p.path.map(y=>y.key).join(".");a[f]=p.message}}),a}return(t,a)=>($(),x("form",{onSubmit:w(l,["prevent"])},[j(t.$slots,"default",{errors:i.value})],32))}});export{H as _,B as a,z as b,F as d,D as e,A as f,N as m,G as n,O as o,X as p,L as s};
