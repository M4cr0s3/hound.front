import{aa as P,i as _,d as z,c as D,k as K,j as q,w as y,o as n,a as o,m as d,u as e,b as t,a4 as b,e as l,n as N,t as r,F as R,l as T,g as k,a5 as w,p as G}from"./index-BJM9FpXo.js";import{_ as H}from"./EmptyState.vue_vue_type_script_setup_true_lang-BdG-MbLV.js";import{h as J,I as v}from"./client-D6K6htDN.js";import{_ as j}from"./Badge.vue_vue_type_script_setup_true_lang-CWRgq3ED.js";import"./StacktraceViewer.vue_vue_type_style_index_0_scoped_7fdb99e3_lang-B8VJLqpg.js";import{_ as Q,S as U}from"./StacktraceViewer-Dzlzqh_U.js";import{P as W}from"./platforms-D8ztvdxx.js";import{a as X}from"./DashboardLayout.vue_vue_type_script_setup_true_lang-CjAASZmf.js";import{b as F,c as Y,d as Z,f as M,g as ee,e as te}from"./index-CaLwU_wJ.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-B9uLu0-5.js";import"./users-BNnsnLpB.js";import"./projects-CJzepl33.js";const ae=P("events",()=>{const p=_([]),x=_({id:0,type:"",level:"info",metadata:{"":"",fingerprint:""},event_id:"",count:0,message:"",release:"",project_id:0,environment:"",project:{},issues:[],created_at:"",updated_at:"",deleted_at:null}),s=_(!1);return{events:p,event:x,fetchEvent:async f=>{s.value=!0;try{x.value=await J.get(`/events/${f}`)}finally{s.value=!1}}}}),ne={key:0,class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},oe={class:"flex items-center mb-6"},ie={class:"inline-flex items-center space-x-1 md:space-x-2"},le={class:"flex items-center"},re={key:0,class:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6"},de={class:"flex items-center gap-3"},ce={class:"text-xl font-semibold text-gray-900 line-clamp-2"},me={class:"flex items-center gap-2 mt-1"},ve={key:0,class:"text-xs text-gray-500"},xe={key:1,class:"text-xs px-2 py-0.5 bg-gray-100 text-gray-600 rounded-full"},ue={class:"mb-6"},_e={class:"flex space-x-4 border-b border-gray-200"},pe=["onClick"],fe={key:0,class:"absolute inset-x-0 bottom-0 h-0.5 bg-indigo-600"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"},he={class:"bg-white rounded-lg shadow overflow-hidden"},ye={class:"px-6 py-4 space-y-4"},be={key:0,class:"flex items-start"},ke={class:"text-sm text-gray-900 font-mono break-all"},we={key:1,class:"flex items-start"},je={key:2,class:"flex items-start"},Se={class:"text-sm text-gray-900"},Ce={key:3,class:"flex items-start"},$e={class:"text-sm text-gray-900"},Le={class:"bg-white rounded-lg shadow overflow-hidden"},Ie={class:"px-6 py-4"},Ve={class:"flex items-center"},Ee={class:"flex-shrink-0 h-10 w-10 flex items-center justify-center p-3 bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-xl shadow-md"},Be={class:"ml-4"},De={class:"text-sm font-medium text-gray-900"},Ne={class:"text-sm text-gray-500"},Re={key:0,class:"bg-white rounded-lg shadow overflow-hidden mb-6"},Te={class:"px-6 py-4"},Fe={key:1},Me={key:0,class:"bg-white rounded-lg shadow overflow-hidden mb-6"},Ae={class:"divide-y divide-gray-200"},Oe={class:"flex items-center justify-between"},Pe={class:"flex items-center gap-2"},ze={class:"text-sm font-medium text-gray-900"},Ke={class:"text-sm text-gray-500 mt-1"},qe={key:1,class:"bg-white rounded-lg shadow overflow-hidden"},Ge=z({__name:"Show",props:{id:{}},setup(p){const x=p,s=ae(),c=_("details"),f=[{id:"details",name:"Детали"},{id:"stacktrace",name:"Stacktrace"},{id:"issues",name:"Проблемы"}],A=D(()=>{const g=s.event.metadata||{},a=["file","line","stacktrace"];return Object.keys(g).some(m=>!a.includes(m))}),O=D(()=>{const{file:g,line:a,stacktrace:m,...u}=s.event.metadata||{};return u});return K(async()=>{await s.fetchEvent(+x.id)}),(g,a)=>{const m=G("RouterLink");return n(),q(X,null,{default:y(()=>{var u,S,C,$,L,I,V,E;return[(u=e(s))!=null&&u.event?(n(),o("div",ne,[t("nav",oe,[t("ol",ie,[t("li",null,[t("div",le,[l(e(v),{icon:"mdi:chevron-right",class:"h-4 w-4 text-gray-400"}),a[0]||(a[0]=t("span",{class:"ml-1 text-sm font-medium text-gray-500 md:ml-2"},"Детали события",-1))])])])]),e(s).event?(n(),o("div",re,[t("div",de,[t("div",{class:N(["p-2 rounded-lg",`bg-${e(F)(e(s).event.level)}-100 text-${e(F)(e(s).event.level)}-600`])},[l(e(v),{icon:e(Y)(e(s).event.level),class:"h-5 w-5"},null,8,["icon"])],2),t("div",null,[t("h1",ce,r(e(s).event.message),1),t("div",me,[l(e(j),{variant:e(Z)(e(s).event.level),text:e(s).event.level,class:"text-xs"},null,8,["variant","text"]),(S=e(s))!=null&&S.event.created_at?(n(),o("span",ve,r(e(M)(e(s).event.created_at)),1)):d("",!0),e(s).event.count>1?(n(),o("span",xe," Повторений: "+r(e(s).event.count),1)):d("",!0)])])])])):d("",!0),t("div",ue,[t("nav",_e,[(n(),o(R,null,T(f,i=>t("button",{key:i.id,onClick:h=>c.value=i.id,class:N(["px-4 py-2 text-sm font-medium relative cursor-pointer",{"text-indigo-600":c.value===i.id,"text-gray-500 hover:text-gray-700":c.value!==i.id}])},[k(r(i.name)+" ",1),c.value===i.id?(n(),o("span",fe)):d("",!0)],10,pe)),64))])]),b(t("div",null,[t("div",ge,[t("div",he,[a[5]||(a[5]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-sm font-medium text-gray-900"},"Основная информация")],-1)),t("div",ye,[(C=e(s).event.metadata)!=null&&C.file?(n(),o("div",be,[a[1]||(a[1]=t("span",{class:"text-sm text-gray-500 w-32 flex-shrink-0"},"Файл:",-1)),t("span",ke,r(e(s).event.metadata.file)+":"+r(e(s).event.metadata.line||"?"),1)])):d("",!0),e(s).event.type?(n(),o("div",we,[a[2]||(a[2]=t("span",{class:"text-sm text-gray-500 w-32 flex-shrink-0"},"Тип:",-1)),l(e(j),{text:e(s).event.type,class:"text-xs",variant:"default"},null,8,["text"])])):d("",!0),e(s).event.environment?(n(),o("div",je,[a[3]||(a[3]=t("span",{class:"text-sm text-gray-500 w-32 flex-shrink-0"},"Окружение:",-1)),t("span",Se,r(e(s).event.environment),1)])):d("",!0),e(s).event.release?(n(),o("div",Ce,[a[4]||(a[4]=t("span",{class:"text-sm text-gray-500 w-32 flex-shrink-0"},"Релиз:",-1)),t("span",$e,r(e(s).event.release),1)])):d("",!0)])]),t("div",Le,[a[7]||(a[7]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-sm font-medium text-gray-900"},"Проект")],-1)),t("div",Ie,[t("div",Ve,[t("div",Ee,[l(e(v),{icon:(($=e(W).find(i=>{var h,B;return i.name===((B=(h=e(s))==null?void 0:h.event.project)==null?void 0:B.platform)}))==null?void 0:$.icon)||" ",class:"h-5 w-5"},null,8,["icon"])]),t("div",Be,[t("h4",De,r((L=e(s).event.project)==null?void 0:L.name),1),t("p",Ne,r((I=e(s).event.project)==null?void 0:I.slug),1),l(m,{to:`/projects/${(V=e(s).event.project)==null?void 0:V.slug}`,class:"mt-1 inline-flex items-center text-xs text-indigo-600 hover:text-indigo-800"},{default:y(()=>[a[6]||(a[6]=k(" Перейти в проект ")),l(e(v),{icon:"mdi:chevron-right",class:"h-4 w-4"})]),_:1,__:[6]},8,["to"])])])])])]),A.value?(n(),o("div",Re,[a[8]||(a[8]=t("div",{class:"px-6 py-4 border-b border-gray-200"},[t("h3",{class:"text-sm font-medium text-gray-900"},"Контекст события")],-1)),t("div",Te,[l(e(Q),{class:"text-sm",data:O.value},null,8,["data"])])])):d("",!0)],512),[[w,c.value==="details"]]),e(s).event.metadata.stacktrace?b((n(),o("div",Fe,[l(e(U),{stacktrace:e(s).event.metadata.stacktrace,class:"mb-6"},null,8,["stacktrace"])],512)),[[w,c.value==="stacktrace"&&((E=e(s).event)==null?void 0:E.metadata.stacktrace)]]):d("",!0),b(t("div",null,[e(s).event.issues&&e(s).event.issues.length>0?(n(),o("div",Me,[a[10]||(a[10]=t("div",{class:"px-6 py-4 border-b border-gray-200 flex justify-between items-center"},[t("h3",{class:"text-sm font-medium text-gray-900"},"Связанные проблемы")],-1)),t("div",Ae,[(n(!0),o(R,null,T(e(s).event.issues,i=>(n(),o("div",{key:i.id,class:"px-6 py-4 hover:bg-gray-50"},[t("div",Oe,[t("div",null,[t("div",Pe,[t("h4",ze,r(i.title),1),l(e(j),{variant:e(te)(i.status),text:e(ee)(i.status),class:"text-xs"},null,8,["variant","text"])]),t("p",Ke," Создана "+r(e(M)(i.created_at)),1)]),l(m,{to:`/issues/${i.id}`,class:"inline-flex items-center text-sm text-indigo-600 hover:text-indigo-800"},{default:y(()=>[a[9]||(a[9]=k(" Подробнее ")),l(e(v),{icon:"mdi:chevron-right",class:"h-4 w-4"})]),_:2,__:[9]},1032,["to"])])]))),128))])])):(n(),o("div",qe,[l(e(H),{title:"Нет связанных задач",description:"Это событие еще не связано ни с одной задачей.",icon:"mdi:alert-circle-outline"})]))],512),[[w,c.value==="issues"]])])):d("",!0)]}),_:1})}}}),ot=se(Ge,[["__scopeId","data-v-7356793f"]]);export{ot as default};
